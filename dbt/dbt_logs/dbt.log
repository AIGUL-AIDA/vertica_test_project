2021-05-30 20:08:50.914077 (MainThread): Running with dbt=0.18.2
2021-05-30 20:08:51.125083 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='seed', selector_name=None, show=True, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-30 20:08:51.127086 (MainThread): Tracking: tracking
2021-05-30 20:08:51.128087 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E23C0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E2483B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E24837C0>]}
2021-05-30 20:08:51.158086 (MainThread): Partial parsing not enabled
2021-05-30 20:08:51.160085 (MainThread): Parsing macros\adapters.sql
2021-05-30 20:08:51.200295 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-30 20:08:51.210390 (MainThread): Parsing macros\materializations\seed.sql
2021-05-30 20:08:51.236392 (MainThread): Parsing macros\materializations\table.sql
2021-05-30 20:08:51.247390 (MainThread): Parsing macros\materializations\view.sql
2021-05-30 20:08:51.252391 (MainThread): Parsing macros\core.sql
2021-05-30 20:08:51.259394 (MainThread): Parsing macros\adapters\common.sql
2021-05-30 20:08:51.327395 (MainThread): Parsing macros\etc\datetime.sql
2021-05-30 20:08:51.341396 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-30 20:08:51.343397 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-30 20:08:51.347436 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-30 20:08:51.350437 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-30 20:08:51.354440 (MainThread): Parsing macros\etc\query.sql
2021-05-30 20:08:51.356396 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-30 20:08:51.371398 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-30 20:08:51.392398 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-30 20:08:51.396397 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-30 20:08:51.406397 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-30 20:08:51.437400 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-30 20:08:51.478411 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-30 20:08:51.481402 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-30 20:08:51.518402 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-30 20:08:51.530402 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-30 20:08:51.541406 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-30 20:08:51.551407 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-30 20:08:51.556406 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-30 20:08:51.559407 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-30 20:08:51.563407 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-30 20:08:51.575405 (MainThread): Partial parsing not enabled
2021-05-30 20:08:51.855094 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.marts
- models.test_model
- models.staging
- seeds.test_model.cwurData
- seeds.test_model

2021-05-30 20:08:51.914094 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-05-30 20:08:51.915095 (MainThread): 
2021-05-30 20:08:51.916095 (MainThread): Acquiring new vertica connection "master".
2021-05-30 20:08:51.927096 (ThreadPoolExecutor-0_0): Acquiring new vertica connection "list_docker".
2021-05-30 20:08:51.941096 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker".
2021-05-30 20:08:51.941096 (ThreadPoolExecutor-0_0): On list_docker: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker"} */

    select schema_name
    from v_catalog.schemata
  
2021-05-30 20:08:51.942097 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 20:08:51.966663 (ThreadPoolExecutor-0_0): :P Connected to database: docker at localhost
2021-05-30 20:08:51.998446 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.06 seconds
2021-05-30 20:08:52.002443 (ThreadPoolExecutor-0_0): On list_docker: Close
2021-05-30 20:08:52.016951 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-05-30 20:08:52.025623 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-05-30 20:08:52.025623 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-05-30 20:08:52.025623 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-30 20:08:52.036542 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-05-30 20:08:52.040595 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.01 seconds
2021-05-30 20:08:52.041137 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-05-30 20:08:52.041137 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-05-30 20:08:52.058045 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-05-30 20:08:52.062043 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-05-30 20:08:52.066045 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-05-30 20:08:52.067045 (MainThread): Using vertica connection "master".
2021-05-30 20:08:52.067045 (MainThread): On master: BEGIN
2021-05-30 20:08:52.068051 (MainThread): Opening a new connection, currently in state init
2021-05-30 20:08:52.079049 (MainThread): :P Connected to database: docker at localhost
2021-05-30 20:08:52.083051 (MainThread): SQL status: -1 in 0.02 seconds
2021-05-30 20:08:52.083051 (MainThread): On master: COMMIT
2021-05-30 20:08:52.083051 (MainThread): Using vertica connection "master".
2021-05-30 20:08:52.083051 (MainThread): On master: COMMIT
2021-05-30 20:08:52.088049 (MainThread): SQL status: -1 in 0.00 seconds
2021-05-30 20:08:52.088049 (MainThread): On master: Close
2021-05-30 20:08:52.089050 (MainThread): 00:08:52 | Concurrency: 1 threads (target='dev')
2021-05-30 20:08:52.090052 (MainThread): 00:08:52 | 
2021-05-30 20:08:52.097045 (Thread-1): Began running node seed.vertica_test_project.cwurData
2021-05-30 20:08:52.099045 (Thread-1): 00:08:52 | 1 of 6 START seed file dbt_schema.cwurData........................... [RUN]
2021-05-30 20:08:52.100046 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:08:52.100046 (Thread-1): finished collecting timing info
2021-05-30 20:08:52.508077 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:08:52.508077 (Thread-1): On seed.vertica_test_project.cwurData: BEGIN
2021-05-30 20:08:52.508077 (Thread-1): Opening a new connection, currently in state init
2021-05-30 20:08:52.518686 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:08:52.522557 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:08:52.523064 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:08:52.523104 (Thread-1): On seed.vertica_test_project.cwurData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.cwurData"} */
truncate table "docker"."dbt_schema"."cwurData"
2021-05-30 20:08:52.535570 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:08:52.552278 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-05-30 20:08:52.552278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b54bbf2e-80b6-4c1a-a2ca-e72b53e692ed', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E28AF9A0>]}
2021-05-30 20:08:52.553288 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.cwurData"
2021-05-30 20:08:52.555279 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:08:52.555279 (Thread-1): On seed.vertica_test_project.cwurData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.cwurData"} */

    truncate table "docker"."dbt_schema"."cwurData";
    -- dbt seed --
    
        copy "docker"."dbt_schema"."cwurData"
        (world_rank, institution, country, national_rank, quality_of_education, alumni_employment, quality_of_faculty, publications, influence, citations, broad_impact, patents, score, year)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\cwurData.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:08:52.571910 (Thread-1): SQL status: -1 in 0.02 seconds
2021-05-30 20:08:52.584512 (Thread-1): On seed.vertica_test_project.cwurData: COMMIT
2021-05-30 20:08:52.585511 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:08:52.585511 (Thread-1): On seed.vertica_test_project.cwurData: COMMIT
2021-05-30 20:08:52.589725 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:08:52.593138 (Thread-1): finished collecting timing info
2021-05-30 20:08:52.593138 (Thread-1): On seed.vertica_test_project.cwurData: Close
2021-05-30 20:08:52.594877 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54bbf2e-80b6-4c1a-a2ca-e72b53e692ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E271E460>]}
2021-05-30 20:08:52.595531 (Thread-1): 00:08:52 | 1 of 6 OK loaded seed file dbt_schema.cwurData....................... [-1 in 0.49s]
2021-05-30 20:08:52.596683 (Thread-1): Finished running node seed.vertica_test_project.cwurData
2021-05-30 20:08:52.597229 (Thread-1): Began running node seed.vertica_test_project.education_expenditure_supplementary_data
2021-05-30 20:08:52.598883 (Thread-1): 00:08:52 | 2 of 6 START seed file dbt_schema.education_expenditure_supplementary_data [RUN]
2021-05-30 20:08:52.599962 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-05-30 20:08:52.599962 (Thread-1): finished collecting timing info
2021-05-30 20:08:52.641980 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.education_expenditure_supplementary_data"
2021-05-30 20:08:52.643979 (Thread-1): Using vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-05-30 20:08:52.643979 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: BEGIN
2021-05-30 20:08:52.643979 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:08:52.654051 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:08:52.657916 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:08:52.658467 (Thread-1): Using vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-05-30 20:08:52.658467 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.education_expenditure_supplementary_data"} */

    
    create table "docker"."dbt_schema"."education_expenditure_supplementary_data" (country varchar(20),institute_type varchar(38),direct_expenditure_type varchar(7),1995 numeric(18,1),2000 numeric(18,1),2005 numeric(18,1),2009 numeric(18,1),2010 numeric(18,1),2011 numeric(18,1))
  ;
    -- dbt seed --
    
        copy "docker"."dbt_schema"."education_expenditure_supplementary_data"
        (country, institute_type, direct_expenditure_type, 1995, 2000, 2005, 2009, 2010, 2011)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\education_expenditure_supplementary_data.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:08:52.662397 (Thread-1): :P Database error: Severity: ERROR, Message: Syntax error at or near "1995", Sqlstate: 42601, Position: 361, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.education_expenditure_supplementary_data"} */          create table "docker"."dbt_schema"."education_expenditure_supplementary_data" (country varchar(20),institute_type varchar(38),direct_expenditure_type varchar(7),1995 numeric(18,1),2000 numeric(18,1),2005 numeric(18,1),2009 numeric(18,1),2010 numeric(18,1),2011 numeric(18,1))   ;     -- dbt seed --              copy "docker"."dbt_schema"."education_expenditure_supplementary_data"         (country, institute_type, direct_expenditure_type, 1995, 2000, 2005, 2009, 2010, 2011)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\education_expenditure_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
2021-05-30 20:08:52.662938 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: ROLLBACK
2021-05-30 20:08:52.666831 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: Close
2021-05-30 20:08:52.667393 (Thread-1): finished collecting timing info
2021-05-30 20:08:52.669131 (Thread-1): Database Error in seed education_expenditure_supplementary_data (data\education_expenditure_supplementary_data.csv)
  Severity: ERROR, Message: Syntax error at or near "1995", Sqlstate: 42601, Position: 361, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.education_expenditure_supplementary_data"} */          create table "docker"."dbt_schema"."education_expenditure_supplementary_data" (country varchar(20),institute_type varchar(38),direct_expenditure_type varchar(7),1995 numeric(18,1),2000 numeric(18,1),2005 numeric(18,1),2009 numeric(18,1),2010 numeric(18,1),2011 numeric(18,1))   ;     -- dbt seed --              copy "docker"."dbt_schema"."education_expenditure_supplementary_data"         (country, institute_type, direct_expenditure_type, 1995, 2000, 2005, 2009, 2010, 2011)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\education_expenditure_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
  compiled SQL at target\run\vertica_test_project\data\education_expenditure_supplementary_data.csv
Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 97, in exception_handler
    yield
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 222, in execute
    self._execute_simple_query(operation)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 606, in _execute_simple_query
    raise errors.QueryError.from_error_response(self._message, query)
vertica_python.errors.VerticaSyntaxError: Severity: ERROR, Message: Syntax error at or near "1995", Sqlstate: 42601, Position: 361, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.education_expenditure_supplementary_data"} */          create table "docker"."dbt_schema"."education_expenditure_supplementary_data" (country varchar(20),institute_type varchar(38),direct_expenditure_type varchar(7),1995 numeric(18,1),2000 numeric(18,1),2005 numeric(18,1),2009 numeric(18,1),2010 numeric(18,1),2011 numeric(18,1))   ;     -- dbt seed --              copy "docker"."dbt_schema"."education_expenditure_supplementary_data"         (country, institute_type, direct_expenditure_type, 1995, 2000, 2005, 2009, 2010, 2011)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\education_expenditure_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 105, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\programdata\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 101, in exception_handler
    raise dbt.exceptions.DatabaseException(str(exc))
dbt.exceptions.DatabaseException: Database Error in seed education_expenditure_supplementary_data (data\education_expenditure_supplementary_data.csv)
  Severity: ERROR, Message: Syntax error at or near "1995", Sqlstate: 42601, Position: 361, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.education_expenditure_supplementary_data"} */          create table "docker"."dbt_schema"."education_expenditure_supplementary_data" (country varchar(20),institute_type varchar(38),direct_expenditure_type varchar(7),1995 numeric(18,1),2000 numeric(18,1),2005 numeric(18,1),2009 numeric(18,1),2010 numeric(18,1),2011 numeric(18,1))   ;     -- dbt seed --              copy "docker"."dbt_schema"."education_expenditure_supplementary_data"         (country, institute_type, direct_expenditure_type, 1995, 2000, 2005, 2009, 2010, 2011)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\education_expenditure_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
  compiled SQL at target\run\vertica_test_project\data\education_expenditure_supplementary_data.csv
2021-05-30 20:08:52.679296 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54bbf2e-80b6-4c1a-a2ca-e72b53e692ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E28B7D90>]}
2021-05-30 20:08:52.679842 (Thread-1): 00:08:52 | 2 of 6 ERROR loading seed file dbt_schema.education_expenditure_supplementary_data [ERROR in 0.08s]
2021-05-30 20:08:52.680351 (Thread-1): Finished running node seed.vertica_test_project.education_expenditure_supplementary_data
2021-05-30 20:08:52.681363 (Thread-1): Began running node seed.vertica_test_project.educational_attainment_supplementary_data
2021-05-30 20:08:52.684364 (Thread-1): 00:08:52 | 3 of 6 START seed file dbt_schema.educational_attainment_supplementary_data [RUN]
2021-05-30 20:08:52.685361 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-05-30 20:08:52.685361 (Thread-1): finished collecting timing info
2021-05-30 20:09:10.550274 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.educational_attainment_supplementary_data"
2021-05-30 20:09:10.552274 (Thread-1): Using vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-05-30 20:09:10.552274 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: BEGIN
2021-05-30 20:09:10.553274 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:09:10.564607 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:09:10.568493 (Thread-1): SQL status: -1 in 0.02 seconds
2021-05-30 20:09:10.569025 (Thread-1): Using vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-05-30 20:09:10.569025 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.educational_attainment_supplementary_data"} */

    
    create table "docker"."dbt_schema"."educational_attainment_supplementary_data" (country_name varchar(62),series_name varchar(136),1985 numeric(18,5),1986 numeric(18,5),1987 numeric(18,5),1990 numeric(18,5),1991 numeric(18,5),1992 numeric(18,5),1993 numeric(18,5),1995 numeric(18,9),1996 numeric(18,5),1997 integer,1998 numeric(18,9),1999 numeric(18,5),2000 numeric(18,9),2001 numeric(18,9),2002 numeric(18,9),2003 numeric(18,9),2004 numeric(18,9),2005 numeric(18,9),2006 numeric(18,9),2007 numeric(18,9),2008 numeric(18,9),2009 numeric(18,9),2010 numeric(18,9),2011 numeric(18,9),2012 numeric(18,9),2013 numeric(18,9),2015 integer)
  ;
    -- dbt seed --
    
        copy "docker"."dbt_schema"."educational_attainment_supplementary_data"
        (country_name, series_name, 1985, 1986, 1987, 1990, 1991, 1992, 1993, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2015)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\educational_attainment_supplementary_data.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:09:10.573036 (Thread-1): :P Database error: Severity: ERROR, Message: Syntax error at or near "1985", Sqlstate: 42601, Position: 331, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.educational_attainment_supplementary_data"} */          create table "docker"."dbt_schema"."educational_attainment_supplementary_data" (country_name varchar(62),series_name varchar(136),1985 numeric(18,5),1986 numeric(18,5),1987 numeric(18,5),1990 numeric(18,5),1991 numeric(18,5),1992 numeric(18,5),1993 numeric(18,5),1995 numeric(18,9),1996 numeric(18,5),1997 integer,1998 numeric(18,9),1999 numeric(18,5),2000 numeric(18,9),2001 numeric(18,9),2002 numeric(18,9),2003 numeric(18,9),2004 numeric(18,9),2005 numeric(18,9),2006 numeric(18,9),2007 numeric(18,9),2008 numeric(18,9),2009 numeric(18,9),2010 numeric(18,9),2011 numeric(18,9),2012 numeric(18,9),2013 numeric(18,9),2015 integer)   ;     -- dbt seed --              copy "docker"."dbt_schema"."educational_attainment_supplementary_data"         (country_name, series_name, 1985, 1986, 1987, 1990, 1991, 1992, 1993, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2015)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\educational_attainment_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
2021-05-30 20:09:10.573576 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: ROLLBACK
2021-05-30 20:09:10.577451 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: Close
2021-05-30 20:09:10.577995 (Thread-1): finished collecting timing info
2021-05-30 20:09:10.579293 (Thread-1): Database Error in seed educational_attainment_supplementary_data (data\educational_attainment_supplementary_data.csv)
  Severity: ERROR, Message: Syntax error at or near "1985", Sqlstate: 42601, Position: 331, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.educational_attainment_supplementary_data"} */          create table "docker"."dbt_schema"."educational_attainment_supplementary_data" (country_name varchar(62),series_name varchar(136),1985 numeric(18,5),1986 numeric(18,5),1987 numeric(18,5),1990 numeric(18,5),1991 numeric(18,5),1992 numeric(18,5),1993 numeric(18,5),1995 numeric(18,9),1996 numeric(18,5),1997 integer,1998 numeric(18,9),1999 numeric(18,5),2000 numeric(18,9),2001 numeric(18,9),2002 numeric(18,9),2003 numeric(18,9),2004 numeric(18,9),2005 numeric(18,9),2006 numeric(18,9),2007 numeric(18,9),2008 numeric(18,9),2009 numeric(18,9),2010 numeric(18,9),2011 numeric(18,9),2012 numeric(18,9),2013 numeric(18,9),2015 integer)   ;     -- dbt seed --              copy "docker"."dbt_schema"."educational_attainment_supplementary_data"         (country_name, series_name, 1985, 1986, 1987, 1990, 1991, 1992, 1993, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2015)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\educational_attainment_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
  compiled SQL at target\run\vertica_test_project\data\educational_attainment_supplementary_data.csv
Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 97, in exception_handler
    yield
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 222, in execute
    self._execute_simple_query(operation)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 606, in _execute_simple_query
    raise errors.QueryError.from_error_response(self._message, query)
vertica_python.errors.VerticaSyntaxError: Severity: ERROR, Message: Syntax error at or near "1985", Sqlstate: 42601, Position: 331, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.educational_attainment_supplementary_data"} */          create table "docker"."dbt_schema"."educational_attainment_supplementary_data" (country_name varchar(62),series_name varchar(136),1985 numeric(18,5),1986 numeric(18,5),1987 numeric(18,5),1990 numeric(18,5),1991 numeric(18,5),1992 numeric(18,5),1993 numeric(18,5),1995 numeric(18,9),1996 numeric(18,5),1997 integer,1998 numeric(18,9),1999 numeric(18,5),2000 numeric(18,9),2001 numeric(18,9),2002 numeric(18,9),2003 numeric(18,9),2004 numeric(18,9),2005 numeric(18,9),2006 numeric(18,9),2007 numeric(18,9),2008 numeric(18,9),2009 numeric(18,9),2010 numeric(18,9),2011 numeric(18,9),2012 numeric(18,9),2013 numeric(18,9),2015 integer)   ;     -- dbt seed --              copy "docker"."dbt_schema"."educational_attainment_supplementary_data"         (country_name, series_name, 1985, 1986, 1987, 1990, 1991, 1992, 1993, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2015)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\educational_attainment_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 105, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\programdata\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 101, in exception_handler
    raise dbt.exceptions.DatabaseException(str(exc))
dbt.exceptions.DatabaseException: Database Error in seed educational_attainment_supplementary_data (data\educational_attainment_supplementary_data.csv)
  Severity: ERROR, Message: Syntax error at or near "1985", Sqlstate: 42601, Position: 331, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.educational_attainment_supplementary_data"} */          create table "docker"."dbt_schema"."educational_attainment_supplementary_data" (country_name varchar(62),series_name varchar(136),1985 numeric(18,5),1986 numeric(18,5),1987 numeric(18,5),1990 numeric(18,5),1991 numeric(18,5),1992 numeric(18,5),1993 numeric(18,5),1995 numeric(18,9),1996 numeric(18,5),1997 integer,1998 numeric(18,9),1999 numeric(18,5),2000 numeric(18,9),2001 numeric(18,9),2002 numeric(18,9),2003 numeric(18,9),2004 numeric(18,9),2005 numeric(18,9),2006 numeric(18,9),2007 numeric(18,9),2008 numeric(18,9),2009 numeric(18,9),2010 numeric(18,9),2011 numeric(18,9),2012 numeric(18,9),2013 numeric(18,9),2015 integer)   ;     -- dbt seed --              copy "docker"."dbt_schema"."educational_attainment_supplementary_data"         (country_name, series_name, 1985, 1986, 1987, 1990, 1991, 1992, 1993, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2015)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\educational_attainment_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
  compiled SQL at target\run\vertica_test_project\data\educational_attainment_supplementary_data.csv
2021-05-30 20:09:10.582106 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54bbf2e-80b6-4c1a-a2ca-e72b53e692ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4DD291670>]}
2021-05-30 20:09:10.582657 (Thread-1): 00:09:10 | 3 of 6 ERROR loading seed file dbt_schema.educational_attainment_supplementary_data [ERROR in 17.90s]
2021-05-30 20:09:10.583756 (Thread-1): Finished running node seed.vertica_test_project.educational_attainment_supplementary_data
2021-05-30 20:09:10.584299 (Thread-1): Began running node seed.vertica_test_project.school_and_country_table
2021-05-30 20:09:10.585906 (Thread-1): 00:09:10 | 4 of 6 START seed file dbt_schema.school_and_country_table........... [RUN]
2021-05-30 20:09:10.586435 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:09:10.586963 (Thread-1): finished collecting timing info
2021-05-30 20:09:10.608942 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.school_and_country_table"
2021-05-30 20:09:10.609934 (Thread-1): Using vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:09:10.610937 (Thread-1): On seed.vertica_test_project.school_and_country_table: BEGIN
2021-05-30 20:09:10.610937 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:09:10.622505 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:09:10.627516 (Thread-1): SQL status: -1 in 0.02 seconds
2021-05-30 20:09:10.628113 (Thread-1): Using vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:09:10.628113 (Thread-1): On seed.vertica_test_project.school_and_country_table: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.school_and_country_table"} */

    
    create table "docker"."dbt_schema"."school_and_country_table" (school_name varchar(66),country varchar(24))
  ;
    -- dbt seed --
    
        copy "docker"."dbt_schema"."school_and_country_table"
        (school_name, country)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\school_and_country_table.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:09:10.681072 (Thread-1): SQL status: -1 in 0.05 seconds
2021-05-30 20:09:10.684908 (Thread-1): On seed.vertica_test_project.school_and_country_table: COMMIT
2021-05-30 20:09:10.685436 (Thread-1): Using vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:09:10.685436 (Thread-1): On seed.vertica_test_project.school_and_country_table: COMMIT
2021-05-30 20:09:10.691005 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:09:10.694899 (Thread-1): finished collecting timing info
2021-05-30 20:09:10.695435 (Thread-1): On seed.vertica_test_project.school_and_country_table: Close
2021-05-30 20:09:10.697872 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54bbf2e-80b6-4c1a-a2ca-e72b53e692ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E249D9D0>]}
2021-05-30 20:09:10.698934 (Thread-1): 00:09:10 | 4 of 6 OK loaded seed file dbt_schema.school_and_country_table....... [-1 in 0.11s]
2021-05-30 20:09:10.700115 (Thread-1): Finished running node seed.vertica_test_project.school_and_country_table
2021-05-30 20:09:10.700656 (Thread-1): Began running node seed.vertica_test_project.shanghaiData
2021-05-30 20:09:10.702712 (Thread-1): 00:09:10 | 5 of 6 START seed file dbt_schema.shanghaiData....................... [RUN]
2021-05-30 20:09:10.702712 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:09:10.703710 (Thread-1): finished collecting timing info
2021-05-30 20:09:11.383951 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.shanghaiData"
2021-05-30 20:09:11.384951 (Thread-1): Using vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:09:11.384951 (Thread-1): On seed.vertica_test_project.shanghaiData: BEGIN
2021-05-30 20:09:11.385953 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:09:11.395110 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:09:11.399567 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:09:11.399567 (Thread-1): Using vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:09:11.400121 (Thread-1): On seed.vertica_test_project.shanghaiData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.shanghaiData"} */

    
    create table "docker"."dbt_schema"."shanghaiData" (world_rank varchar(7),university_name varchar(71),national_rank varchar(7),total_score numeric(18,1),alumni numeric(18,1),award numeric(18,1),hici numeric(18,1),ns numeric(18,1),pub numeric(18,1),pcp numeric(18,1),year integer)
  ;
    -- dbt seed --
    
        copy "docker"."dbt_schema"."shanghaiData"
        (world_rank, university_name, national_rank, total_score, alumni, award, hici, ns, pub, pcp, year)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\shanghaiData.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:09:11.430339 (Thread-1): SQL status: -1 in 0.03 seconds
2021-05-30 20:09:11.434271 (Thread-1): On seed.vertica_test_project.shanghaiData: COMMIT
2021-05-30 20:09:11.434271 (Thread-1): Using vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:09:11.434811 (Thread-1): On seed.vertica_test_project.shanghaiData: COMMIT
2021-05-30 20:09:11.439180 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:09:11.441905 (Thread-1): finished collecting timing info
2021-05-30 20:09:11.442450 (Thread-1): On seed.vertica_test_project.shanghaiData: Close
2021-05-30 20:09:11.444093 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54bbf2e-80b6-4c1a-a2ca-e72b53e692ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E281D040>]}
2021-05-30 20:09:11.444667 (Thread-1): 00:09:11 | 5 of 6 OK loaded seed file dbt_schema.shanghaiData................... [-1 in 0.74s]
2021-05-30 20:09:11.445908 (Thread-1): Finished running node seed.vertica_test_project.shanghaiData
2021-05-30 20:09:11.446459 (Thread-1): Began running node seed.vertica_test_project.timesData
2021-05-30 20:09:11.448101 (Thread-1): 00:09:11 | 6 of 6 START seed file dbt_schema.timesData.......................... [RUN]
2021-05-30 20:09:11.449181 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:09:11.449181 (Thread-1): finished collecting timing info
2021-05-30 20:09:11.881837 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.timesData"
2021-05-30 20:09:11.884840 (Thread-1): Using vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:09:11.885840 (Thread-1): On seed.vertica_test_project.timesData: BEGIN
2021-05-30 20:09:11.885840 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:09:11.896663 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:09:11.901204 (Thread-1): SQL status: -1 in 0.02 seconds
2021-05-30 20:09:11.901734 (Thread-1): Using vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:09:11.901734 (Thread-1): On seed.vertica_test_project.timesData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.timesData"} */

    
    create table "docker"."dbt_schema"."timesData" (world_rank varchar(7),university_name varchar(66),country varchar(25),teaching numeric(18,1),international varchar(5),research numeric(18,1),citations numeric(18,1),income varchar(5),total_score varchar(4),num_students integer,student_staff_ratio numeric(18,1),international_students integer,female_male_ratio varchar(7),year integer)
  ;
    -- dbt seed --
    
        copy "docker"."dbt_schema"."timesData"
        (world_rank, university_name, country, teaching, international, research, citations, income, total_score, num_students, student_staff_ratio, international_students, female_male_ratio, year)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\timesData.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:09:11.939105 (Thread-1): SQL status: -1 in 0.04 seconds
2021-05-30 20:09:11.944555 (Thread-1): On seed.vertica_test_project.timesData: COMMIT
2021-05-30 20:09:11.944555 (Thread-1): Using vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:09:11.945100 (Thread-1): On seed.vertica_test_project.timesData: COMMIT
2021-05-30 20:09:11.949647 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:09:11.952399 (Thread-1): finished collecting timing info
2021-05-30 20:09:11.952950 (Thread-1): On seed.vertica_test_project.timesData: Close
2021-05-30 20:09:11.954642 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54bbf2e-80b6-4c1a-a2ca-e72b53e692ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E28B7AF0>]}
2021-05-30 20:09:11.955208 (Thread-1): 00:09:11 | 6 of 6 OK loaded seed file dbt_schema.timesData...................... [-1 in 0.51s]
2021-05-30 20:09:11.956440 (Thread-1): Finished running node seed.vertica_test_project.timesData
2021-05-30 20:09:11.958601 (MainThread): Acquiring new vertica connection "master".
2021-05-30 20:09:11.958601 (MainThread): Using vertica connection "master".
2021-05-30 20:09:11.959132 (MainThread): On master: BEGIN
2021-05-30 20:09:11.959132 (MainThread): Opening a new connection, currently in state closed
2021-05-30 20:09:11.968611 (MainThread): :P Connected to database: docker at localhost
2021-05-30 20:09:11.972994 (MainThread): SQL status: -1 in 0.01 seconds
2021-05-30 20:09:11.973533 (MainThread): On master: COMMIT
2021-05-30 20:09:11.973533 (MainThread): Using vertica connection "master".
2021-05-30 20:09:11.973533 (MainThread): On master: COMMIT
2021-05-30 20:09:11.978518 (MainThread): SQL status: -1 in 0.00 seconds
2021-05-30 20:09:11.979029 (MainThread): On master: Close
2021-05-30 20:09:11.979651 (MainThread): 00:09:11 | 
2021-05-30 20:09:11.980851 (MainThread): 00:09:11 | Finished running 6 seeds in 20.06s.
2021-05-30 20:09:11.981433 (MainThread): Connection 'master' was properly closed.
2021-05-30 20:09:11.981433 (MainThread): Connection 'list_docker' was properly closed.
2021-05-30 20:09:11.982020 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-05-30 20:09:11.982020 (MainThread): Connection 'seed.vertica_test_project.timesData' was properly closed.
2021-05-30 20:09:12.012383 (MainThread): 
2021-05-30 20:09:12.013381 (MainThread): Random sample of table: dbt_schema.cwurData
2021-05-30 20:09:12.014381 (MainThread): -------------------------------------------
2021-05-30 20:09:12.089402 (MainThread): 
2021-05-30 20:09:12.092388 (MainThread): 
2021-05-30 20:09:12.093400 (MainThread): Random sample of table: dbt_schema.school_and_country_table
2021-05-30 20:09:12.094387 (MainThread): -----------------------------------------------------------
2021-05-30 20:09:12.115401 (MainThread): 
2021-05-30 20:09:12.125392 (MainThread): 
2021-05-30 20:09:12.126390 (MainThread): Random sample of table: dbt_schema.shanghaiData
2021-05-30 20:09:12.127387 (MainThread): -----------------------------------------------
2021-05-30 20:09:12.229401 (MainThread): 
2021-05-30 20:09:12.233401 (MainThread): 
2021-05-30 20:09:12.233401 (MainThread): Random sample of table: dbt_schema.timesData
2021-05-30 20:09:12.234401 (MainThread): --------------------------------------------
2021-05-30 20:09:12.293532 (MainThread): 
2021-05-30 20:09:12.294534 (MainThread): 
2021-05-30 20:09:12.294534 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-30 20:09:12.295539 (MainThread): 
2021-05-30 20:09:12.296529 (MainThread): Database Error in seed education_expenditure_supplementary_data (data\education_expenditure_supplementary_data.csv)
2021-05-30 20:09:12.299533 (MainThread):   Severity: ERROR, Message: Syntax error at or near "1995", Sqlstate: 42601, Position: 361, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.education_expenditure_supplementary_data"} */          create table "docker"."dbt_schema"."education_expenditure_supplementary_data" (country varchar(20),institute_type varchar(38),direct_expenditure_type varchar(7),1995 numeric(18,1),2000 numeric(18,1),2005 numeric(18,1),2009 numeric(18,1),2010 numeric(18,1),2011 numeric(18,1))   ;     -- dbt seed --              copy "docker"."dbt_schema"."education_expenditure_supplementary_data"         (country, institute_type, direct_expenditure_type, 1995, 2000, 2005, 2009, 2010, 2011)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\education_expenditure_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
2021-05-30 20:09:12.300530 (MainThread):   compiled SQL at target\run\vertica_test_project\data\education_expenditure_supplementary_data.csv
2021-05-30 20:09:12.303530 (MainThread): 
2021-05-30 20:09:12.303530 (MainThread): Database Error in seed educational_attainment_supplementary_data (data\educational_attainment_supplementary_data.csv)
2021-05-30 20:09:12.304541 (MainThread):   Severity: ERROR, Message: Syntax error at or near "1985", Sqlstate: 42601, Position: 331, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.educational_attainment_supplementary_data"} */          create table "docker"."dbt_schema"."educational_attainment_supplementary_data" (country_name varchar(62),series_name varchar(136),1985 numeric(18,5),1986 numeric(18,5),1987 numeric(18,5),1990 numeric(18,5),1991 numeric(18,5),1992 numeric(18,5),1993 numeric(18,5),1995 numeric(18,9),1996 numeric(18,5),1997 integer,1998 numeric(18,9),1999 numeric(18,5),2000 numeric(18,9),2001 numeric(18,9),2002 numeric(18,9),2003 numeric(18,9),2004 numeric(18,9),2005 numeric(18,9),2006 numeric(18,9),2007 numeric(18,9),2008 numeric(18,9),2009 numeric(18,9),2010 numeric(18,9),2011 numeric(18,9),2012 numeric(18,9),2013 numeric(18,9),2015 integer)   ;     -- dbt seed --              copy "docker"."dbt_schema"."educational_attainment_supplementary_data"         (country_name, series_name, 1985, 1986, 1987, 1990, 1991, 1992, 1993, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2015)         from local \'C:\\Users\\davletova\\vertica_test_project\\dbt\\data\\educational_attainment_supplementary_data.csv\'         delimiter \',\'         enclosed by \'"\'         skip 1         abort on error         rejected data as table "docker"."dbt_schema".seed_rejects;        '
2021-05-30 20:09:12.306563 (MainThread):   compiled SQL at target\run\vertica_test_project\data\educational_attainment_supplementary_data.csv
2021-05-30 20:09:12.313530 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-05-30 20:09:12.314557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E25F3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E270AF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E274E3A0>]}
2021-05-30 20:09:12.315552 (MainThread): Flushing usage events
2021-05-30 20:12:52.054693 (MainThread): Running with dbt=0.18.2
2021-05-30 20:12:52.246046 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='seed', selector_name=None, show=True, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-30 20:12:52.247046 (MainThread): Tracking: tracking
2021-05-30 20:12:52.247046 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10558F9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10564DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10564D2E0>]}
2021-05-30 20:12:52.283049 (MainThread): Partial parsing not enabled
2021-05-30 20:12:52.285043 (MainThread): Parsing macros\adapters.sql
2021-05-30 20:12:52.322046 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-30 20:12:52.334045 (MainThread): Parsing macros\materializations\seed.sql
2021-05-30 20:12:52.362048 (MainThread): Parsing macros\materializations\table.sql
2021-05-30 20:12:52.373060 (MainThread): Parsing macros\materializations\view.sql
2021-05-30 20:12:52.378045 (MainThread): Parsing macros\core.sql
2021-05-30 20:12:52.385044 (MainThread): Parsing macros\adapters\common.sql
2021-05-30 20:12:52.454052 (MainThread): Parsing macros\etc\datetime.sql
2021-05-30 20:12:52.468050 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-30 20:12:52.470084 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-30 20:12:52.473062 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-30 20:12:52.477052 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-30 20:12:52.480085 (MainThread): Parsing macros\etc\query.sql
2021-05-30 20:12:52.483057 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-30 20:12:52.498048 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-30 20:12:52.520084 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-30 20:12:52.523085 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-30 20:12:52.536050 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-30 20:12:52.571055 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-30 20:12:52.613054 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-30 20:12:52.616055 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-30 20:12:52.645382 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-30 20:12:52.656226 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-30 20:12:52.665226 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-30 20:12:52.675225 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-30 20:12:52.680262 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-30 20:12:52.683226 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-30 20:12:52.686260 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-30 20:12:52.699230 (MainThread): Partial parsing not enabled
2021-05-30 20:12:52.977236 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.marts
- models.test_model
- models.staging
- seeds.test_model.cwurData
- seeds.test_model

2021-05-30 20:12:53.038242 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-05-30 20:12:53.040248 (MainThread): 
2021-05-30 20:12:53.041242 (MainThread): Acquiring new vertica connection "master".
2021-05-30 20:12:53.054236 (ThreadPoolExecutor-0_0): Acquiring new vertica connection "list_docker".
2021-05-30 20:12:53.072263 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker".
2021-05-30 20:12:53.073276 (ThreadPoolExecutor-0_0): On list_docker: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker"} */

    select schema_name
    from v_catalog.schemata
  
2021-05-30 20:12:53.073276 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 20:12:53.096785 (ThreadPoolExecutor-0_0): :P Connected to database: docker at localhost
2021-05-30 20:12:53.128606 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.06 seconds
2021-05-30 20:12:53.132616 (ThreadPoolExecutor-0_0): On list_docker: Close
2021-05-30 20:12:53.147713 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-05-30 20:12:53.156581 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-05-30 20:12:53.156581 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-05-30 20:12:53.156581 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-30 20:12:53.166762 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-05-30 20:12:53.170731 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.01 seconds
2021-05-30 20:12:53.170731 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-05-30 20:12:53.171289 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-05-30 20:12:53.188703 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-05-30 20:12:53.193501 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-05-30 20:12:53.197465 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-05-30 20:12:53.199697 (MainThread): Using vertica connection "master".
2021-05-30 20:12:53.199697 (MainThread): On master: BEGIN
2021-05-30 20:12:53.200253 (MainThread): Opening a new connection, currently in state init
2021-05-30 20:12:53.211100 (MainThread): :P Connected to database: docker at localhost
2021-05-30 20:12:53.215023 (MainThread): SQL status: -1 in 0.01 seconds
2021-05-30 20:12:53.215023 (MainThread): On master: COMMIT
2021-05-30 20:12:53.215614 (MainThread): Using vertica connection "master".
2021-05-30 20:12:53.215614 (MainThread): On master: COMMIT
2021-05-30 20:12:53.220798 (MainThread): SQL status: -1 in 0.01 seconds
2021-05-30 20:12:53.220798 (MainThread): On master: Close
2021-05-30 20:12:53.221919 (MainThread): 00:12:53 | Concurrency: 1 threads (target='dev')
2021-05-30 20:12:53.222983 (MainThread): 00:12:53 | 
2021-05-30 20:12:53.234340 (Thread-1): Began running node seed.vertica_test_project.cwurData
2021-05-30 20:12:53.235418 (Thread-1): 00:12:53 | 1 of 6 START seed file dbt_schema.cwurData........................... [RUN]
2021-05-30 20:12:53.236437 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:12:53.236437 (Thread-1): finished collecting timing info
2021-05-30 20:12:53.614583 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:12:53.614583 (Thread-1): On seed.vertica_test_project.cwurData: BEGIN
2021-05-30 20:12:53.614583 (Thread-1): Opening a new connection, currently in state init
2021-05-30 20:12:53.623787 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:12:53.628346 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:12:53.628881 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:12:53.628909 (Thread-1): On seed.vertica_test_project.cwurData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.cwurData"} */
truncate table "docker"."dbt_schema"."cwurData"
2021-05-30 20:12:53.643005 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:12:53.661134 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-05-30 20:12:53.661134 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b62a1e02-7a93-4206-afc9-d07e1dc38266', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D105B46FA0>]}
2021-05-30 20:12:53.663137 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.cwurData"
2021-05-30 20:12:53.664136 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:12:53.665153 (Thread-1): On seed.vertica_test_project.cwurData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.cwurData"} */

    truncate table "docker"."dbt_schema"."cwurData";
    -- dbt seed --
    
        copy "docker"."dbt_schema"."cwurData"
        (world_rank, institution, country, national_rank, quality_of_education, alumni_employment, quality_of_faculty, publications, influence, citations, broad_impact, patents, score, year)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\cwurData.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:12:53.680050 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:12:53.692485 (Thread-1): On seed.vertica_test_project.cwurData: COMMIT
2021-05-30 20:12:53.692485 (Thread-1): Using vertica connection "seed.vertica_test_project.cwurData".
2021-05-30 20:12:53.692485 (Thread-1): On seed.vertica_test_project.cwurData: COMMIT
2021-05-30 20:12:53.697803 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:12:53.700616 (Thread-1): finished collecting timing info
2021-05-30 20:12:53.701167 (Thread-1): On seed.vertica_test_project.cwurData: Close
2021-05-30 20:12:53.702263 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a1e02-7a93-4206-afc9-d07e1dc38266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1059F3250>]}
2021-05-30 20:12:53.702823 (Thread-1): 00:12:53 | 1 of 6 OK loaded seed file dbt_schema.cwurData....................... [-1 in 0.47s]
2021-05-30 20:12:53.704622 (Thread-1): Finished running node seed.vertica_test_project.cwurData
2021-05-30 20:12:53.705173 (Thread-1): Began running node seed.vertica_test_project.education_expenditure_supplementary_data
2021-05-30 20:12:53.706829 (Thread-1): 00:12:53 | 2 of 6 START seed file dbt_schema.education_expenditure_supplementary_data [RUN]
2021-05-30 20:12:53.708438 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-05-30 20:12:53.708506 (Thread-1): finished collecting timing info
2021-05-30 20:12:53.757064 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.education_expenditure_supplementary_data"
2021-05-30 20:12:53.758063 (Thread-1): Using vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-05-30 20:12:53.758063 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: BEGIN
2021-05-30 20:12:53.759071 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:12:53.768551 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:12:53.772438 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:12:53.772438 (Thread-1): Using vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-05-30 20:12:53.772971 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.education_expenditure_supplementary_data"} */

    
    create table "docker"."dbt_schema"."education_expenditure_supplementary_data" (country varchar(20),institute_type varchar(38),direct_expenditure_type varchar(7),f1995 numeric(18,1),f2000 numeric(18,1),f2005 numeric(18,1),f2009 numeric(18,1),f2010 numeric(18,1),f2011 numeric(18,1))
  ;
    -- dbt seed --
    
        copy "docker"."dbt_schema"."education_expenditure_supplementary_data"
        (country, institute_type, direct_expenditure_type, f1995, f2000, f2005, f2009, f2010, f2011)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\education_expenditure_supplementary_data.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:12:53.805380 (Thread-1): SQL status: -1 in 0.03 seconds
2021-05-30 20:12:53.809227 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: COMMIT
2021-05-30 20:12:53.809279 (Thread-1): Using vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-05-30 20:12:53.809279 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: COMMIT
2021-05-30 20:12:53.814220 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:12:53.817504 (Thread-1): finished collecting timing info
2021-05-30 20:12:53.818606 (Thread-1): On seed.vertica_test_project.education_expenditure_supplementary_data: Close
2021-05-30 20:12:53.820381 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a1e02-7a93-4206-afc9-d07e1dc38266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1059A32E0>]}
2021-05-30 20:12:53.821133 (Thread-1): 00:12:53 | 2 of 6 OK loaded seed file dbt_schema.education_expenditure_supplementary_data [-1 in 0.11s]
2021-05-30 20:12:53.822972 (Thread-1): Finished running node seed.vertica_test_project.education_expenditure_supplementary_data
2021-05-30 20:12:53.822972 (Thread-1): Began running node seed.vertica_test_project.educational_attainment_supplementary_data
2021-05-30 20:12:53.825184 (Thread-1): 00:12:53 | 3 of 6 START seed file dbt_schema.educational_attainment_supplementary_data [RUN]
2021-05-30 20:12:53.826175 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-05-30 20:12:53.826175 (Thread-1): finished collecting timing info
2021-05-30 20:13:11.535600 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.educational_attainment_supplementary_data"
2021-05-30 20:13:11.537602 (Thread-1): Using vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-05-30 20:13:11.537602 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: BEGIN
2021-05-30 20:13:11.537602 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:13:11.546980 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:13:11.551536 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:11.551536 (Thread-1): Using vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-05-30 20:13:11.552045 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.educational_attainment_supplementary_data"} */

    
    create table "docker"."dbt_schema"."educational_attainment_supplementary_data" (country_name varchar(62),series_name varchar(136),f1985 numeric(18,5),f1986 numeric(18,5),f1987 numeric(18,5),f1990 numeric(18,5),f1991 numeric(18,5),f1992 numeric(18,5),f1993 numeric(18,5),f1995 numeric(18,9),f1996 numeric(18,5),f1997 integer,f1998 numeric(18,9),f1999 numeric(18,5),f2000 numeric(18,9),f2001 numeric(18,9),f2002 numeric(18,9),f2003 numeric(18,9),f2004 numeric(18,9),f2005 numeric(18,9),f2006 numeric(18,9),f2007 numeric(18,9),f2008 numeric(18,9),f2009 numeric(18,9),f2010 numeric(18,9),f2011 numeric(18,9),f2012 numeric(18,9),f2013 numeric(18,9),f2015 integer)
  ;
    -- dbt seed --
    
        copy "docker"."dbt_schema"."educational_attainment_supplementary_data"
        (country_name, series_name, f1985, f1986, f1987, f1990, f1991, f1992, f1993, f1995, f1996, f1997, f1998, f1999, f2000, f2001, f2002, f2003, f2004, f2005, f2006, f2007, f2008, f2009, f2010, f2011, f2012, f2013, f2015)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\educational_attainment_supplementary_data.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:13:11.593143 (Thread-1): SQL status: -1 in 0.04 seconds
2021-05-30 20:13:11.599000 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: COMMIT
2021-05-30 20:13:11.599512 (Thread-1): Using vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-05-30 20:13:11.599578 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: COMMIT
2021-05-30 20:13:11.604658 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:11.611640 (Thread-1): finished collecting timing info
2021-05-30 20:13:11.612187 (Thread-1): On seed.vertica_test_project.educational_attainment_supplementary_data: Close
2021-05-30 20:13:11.613359 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a1e02-7a93-4206-afc9-d07e1dc38266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D100431670>]}
2021-05-30 20:13:11.613920 (Thread-1): 00:13:11 | 3 of 6 OK loaded seed file dbt_schema.educational_attainment_supplementary_data [-1 in 17.79s]
2021-05-30 20:13:11.615684 (Thread-1): Finished running node seed.vertica_test_project.educational_attainment_supplementary_data
2021-05-30 20:13:11.616234 (Thread-1): Began running node seed.vertica_test_project.school_and_country_table
2021-05-30 20:13:11.619037 (Thread-1): 00:13:11 | 4 of 6 START seed file dbt_schema.school_and_country_table........... [RUN]
2021-05-30 20:13:11.620663 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:13:11.620700 (Thread-1): finished collecting timing info
2021-05-30 20:13:11.634280 (Thread-1): Using vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:13:11.634280 (Thread-1): On seed.vertica_test_project.school_and_country_table: BEGIN
2021-05-30 20:13:11.635290 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:13:11.646208 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:13:11.650121 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:11.650121 (Thread-1): Using vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:13:11.650679 (Thread-1): On seed.vertica_test_project.school_and_country_table: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.school_and_country_table"} */
truncate table "docker"."dbt_schema"."school_and_country_table"
2021-05-30 20:13:11.663799 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:11.665950 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.school_and_country_table"
2021-05-30 20:13:11.667594 (Thread-1): Using vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:13:11.667594 (Thread-1): On seed.vertica_test_project.school_and_country_table: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.school_and_country_table"} */

    truncate table "docker"."dbt_schema"."school_and_country_table";
    -- dbt seed --
    
        copy "docker"."dbt_schema"."school_and_country_table"
        (school_name, country)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\school_and_country_table.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:13:11.682976 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:11.686870 (Thread-1): On seed.vertica_test_project.school_and_country_table: COMMIT
2021-05-30 20:13:11.686870 (Thread-1): Using vertica connection "seed.vertica_test_project.school_and_country_table".
2021-05-30 20:13:11.687384 (Thread-1): On seed.vertica_test_project.school_and_country_table: COMMIT
2021-05-30 20:13:11.691929 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:13:11.694095 (Thread-1): finished collecting timing info
2021-05-30 20:13:11.694639 (Thread-1): On seed.vertica_test_project.school_and_country_table: Close
2021-05-30 20:13:11.696360 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a1e02-7a93-4206-afc9-d07e1dc38266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1055AB550>]}
2021-05-30 20:13:11.696916 (Thread-1): 00:13:11 | 4 of 6 OK loaded seed file dbt_schema.school_and_country_table....... [-1 in 0.08s]
2021-05-30 20:13:11.698571 (Thread-1): Finished running node seed.vertica_test_project.school_and_country_table
2021-05-30 20:13:11.698571 (Thread-1): Began running node seed.vertica_test_project.shanghaiData
2021-05-30 20:13:11.700812 (Thread-1): 00:13:11 | 5 of 6 START seed file dbt_schema.shanghaiData....................... [RUN]
2021-05-30 20:13:11.701381 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:13:11.701980 (Thread-1): finished collecting timing info
2021-05-30 20:13:12.219960 (Thread-1): Using vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:13:12.219960 (Thread-1): On seed.vertica_test_project.shanghaiData: BEGIN
2021-05-30 20:13:12.220518 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:13:12.230079 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:13:12.234035 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:12.234590 (Thread-1): Using vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:13:12.234590 (Thread-1): On seed.vertica_test_project.shanghaiData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.shanghaiData"} */
truncate table "docker"."dbt_schema"."shanghaiData"
2021-05-30 20:13:12.246469 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:12.249349 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.shanghaiData"
2021-05-30 20:13:12.251056 (Thread-1): Using vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:13:12.251056 (Thread-1): On seed.vertica_test_project.shanghaiData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.shanghaiData"} */

    truncate table "docker"."dbt_schema"."shanghaiData";
    -- dbt seed --
    
        copy "docker"."dbt_schema"."shanghaiData"
        (world_rank, university_name, national_rank, total_score, alumni, award, hici, ns, pub, pcp, year)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\shanghaiData.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:13:12.264541 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:12.267976 (Thread-1): On seed.vertica_test_project.shanghaiData: COMMIT
2021-05-30 20:13:12.267976 (Thread-1): Using vertica connection "seed.vertica_test_project.shanghaiData".
2021-05-30 20:13:12.267976 (Thread-1): On seed.vertica_test_project.shanghaiData: COMMIT
2021-05-30 20:13:12.272605 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:13:12.274951 (Thread-1): finished collecting timing info
2021-05-30 20:13:12.275496 (Thread-1): On seed.vertica_test_project.shanghaiData: Close
2021-05-30 20:13:12.277202 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a1e02-7a93-4206-afc9-d07e1dc38266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1058F6EB0>]}
2021-05-30 20:13:12.277768 (Thread-1): 00:13:12 | 5 of 6 OK loaded seed file dbt_schema.shanghaiData................... [-1 in 0.57s]
2021-05-30 20:13:12.279461 (Thread-1): Finished running node seed.vertica_test_project.shanghaiData
2021-05-30 20:13:12.279461 (Thread-1): Began running node seed.vertica_test_project.timesData
2021-05-30 20:13:12.281703 (Thread-1): 00:13:12 | 6 of 6 START seed file dbt_schema.timesData.......................... [RUN]
2021-05-30 20:13:12.282247 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:13:12.282810 (Thread-1): finished collecting timing info
2021-05-30 20:13:12.553696 (Thread-1): Using vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:13:12.553696 (Thread-1): On seed.vertica_test_project.timesData: BEGIN
2021-05-30 20:13:12.553696 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 20:13:12.563374 (Thread-1): :P Connected to database: docker at localhost
2021-05-30 20:13:12.567293 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:12.567293 (Thread-1): Using vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:13:12.567293 (Thread-1): On seed.vertica_test_project.timesData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.timesData"} */
truncate table "docker"."dbt_schema"."timesData"
2021-05-30 20:13:12.579198 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:12.582059 (Thread-1): Writing runtime SQL for node "seed.vertica_test_project.timesData"
2021-05-30 20:13:12.583224 (Thread-1): Using vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:13:12.583772 (Thread-1): On seed.vertica_test_project.timesData: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "seed.vertica_test_project.timesData"} */

    truncate table "docker"."dbt_schema"."timesData";
    -- dbt seed --
    
        copy "docker"."dbt_schema"."timesData"
        (world_rank, university_name, country, teaching, international, research, citations, income, total_score, num_students, student_staff_ratio, international_students, female_male_ratio, year)
        from local 'C:\Users\davletova\vertica_test_project\dbt\data\timesData.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "docker"."dbt_schema".seed_rejects;
    
  
2021-05-30 20:13:12.596274 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:12.599625 (Thread-1): On seed.vertica_test_project.timesData: COMMIT
2021-05-30 20:13:12.600181 (Thread-1): Using vertica connection "seed.vertica_test_project.timesData".
2021-05-30 20:13:12.600181 (Thread-1): On seed.vertica_test_project.timesData: COMMIT
2021-05-30 20:13:12.604536 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-30 20:13:12.606736 (Thread-1): finished collecting timing info
2021-05-30 20:13:12.607290 (Thread-1): On seed.vertica_test_project.timesData: Close
2021-05-30 20:13:12.609002 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a1e02-7a93-4206-afc9-d07e1dc38266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1057EE4F0>]}
2021-05-30 20:13:12.609839 (Thread-1): 00:13:12 | 6 of 6 OK loaded seed file dbt_schema.timesData...................... [-1 in 0.33s]
2021-05-30 20:13:12.610934 (Thread-1): Finished running node seed.vertica_test_project.timesData
2021-05-30 20:13:12.612853 (MainThread): Acquiring new vertica connection "master".
2021-05-30 20:13:12.613407 (MainThread): Using vertica connection "master".
2021-05-30 20:13:12.613407 (MainThread): On master: BEGIN
2021-05-30 20:13:12.613407 (MainThread): Opening a new connection, currently in state closed
2021-05-30 20:13:12.623117 (MainThread): :P Connected to database: docker at localhost
2021-05-30 20:13:12.626760 (MainThread): SQL status: -1 in 0.01 seconds
2021-05-30 20:13:12.626760 (MainThread): On master: COMMIT
2021-05-30 20:13:12.627675 (MainThread): Using vertica connection "master".
2021-05-30 20:13:12.627675 (MainThread): On master: COMMIT
2021-05-30 20:13:12.632409 (MainThread): SQL status: -1 in 0.00 seconds
2021-05-30 20:13:12.632969 (MainThread): On master: Close
2021-05-30 20:13:12.634025 (MainThread): 00:13:12 | 
2021-05-30 20:13:12.634641 (MainThread): 00:13:12 | Finished running 6 seeds in 19.59s.
2021-05-30 20:13:12.639688 (MainThread): Connection 'master' was properly closed.
2021-05-30 20:13:12.639688 (MainThread): Connection 'list_docker' was properly closed.
2021-05-30 20:13:12.640309 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-05-30 20:13:12.640309 (MainThread): Connection 'seed.vertica_test_project.timesData' was properly closed.
2021-05-30 20:13:12.669839 (MainThread): 
2021-05-30 20:13:12.669839 (MainThread): Random sample of table: dbt_schema.cwurData
2021-05-30 20:13:12.671830 (MainThread): -------------------------------------------
2021-05-30 20:13:12.764316 (MainThread): 
2021-05-30 20:13:12.765311 (MainThread): 
2021-05-30 20:13:12.766311 (MainThread): Random sample of table: dbt_schema.education_expenditure_supplementary_data
2021-05-30 20:13:12.766311 (MainThread): ---------------------------------------------------------------------------
2021-05-30 20:13:12.788307 (MainThread): 
2021-05-30 20:13:13.083327 (MainThread): 
2021-05-30 20:13:13.084322 (MainThread): Random sample of table: dbt_schema.educational_attainment_supplementary_data
2021-05-30 20:13:13.086320 (MainThread): ----------------------------------------------------------------------------
2021-05-30 20:13:17.377281 (MainThread): 
2021-05-30 20:13:17.381282 (MainThread): 
2021-05-30 20:13:17.382286 (MainThread): Random sample of table: dbt_schema.school_and_country_table
2021-05-30 20:13:17.386340 (MainThread): -----------------------------------------------------------
2021-05-30 20:13:17.399281 (MainThread): 
2021-05-30 20:13:17.407320 (MainThread): 
2021-05-30 20:13:17.407320 (MainThread): Random sample of table: dbt_schema.shanghaiData
2021-05-30 20:13:17.408276 (MainThread): -----------------------------------------------
2021-05-30 20:13:17.505284 (MainThread): 
2021-05-30 20:13:17.510303 (MainThread): 
2021-05-30 20:13:17.511283 (MainThread): Random sample of table: dbt_schema.timesData
2021-05-30 20:13:17.512279 (MainThread): --------------------------------------------
2021-05-30 20:13:17.571293 (MainThread): 
2021-05-30 20:13:17.572284 (MainThread): 
2021-05-30 20:13:17.573286 (MainThread): Completed successfully
2021-05-30 20:13:17.574282 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-05-30 20:13:17.574282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D10535FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D100431670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D100431B80>]}
2021-05-30 20:13:17.575284 (MainThread): Flushing usage events
2021-05-31 19:33:04.131760 (MainThread): Running with dbt=0.18.2
2021-05-31 19:33:04.772052 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 19:33:04.774055 (MainThread): Tracking: tracking
2021-05-31 19:33:04.775055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D106B0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D1077DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D1077D220>]}
2021-05-31 19:33:04.810668 (MainThread): Partial parsing not enabled
2021-05-31 19:33:04.814769 (MainThread): Parsing macros\adapters.sql
2021-05-31 19:33:04.868693 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-31 19:33:04.881694 (MainThread): Parsing macros\materializations\seed.sql
2021-05-31 19:33:04.906707 (MainThread): Parsing macros\materializations\table.sql
2021-05-31 19:33:04.932694 (MainThread): Parsing macros\materializations\view.sql
2021-05-31 19:33:04.941694 (MainThread): Parsing macros\core.sql
2021-05-31 19:33:04.951693 (MainThread): Parsing macros\adapters\common.sql
2021-05-31 19:33:05.041692 (MainThread): Parsing macros\etc\datetime.sql
2021-05-31 19:33:05.059302 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-31 19:33:05.063275 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-31 19:33:05.083276 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-31 19:33:05.087275 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-31 19:33:05.105276 (MainThread): Parsing macros\etc\query.sql
2021-05-31 19:33:05.127274 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-31 19:33:05.167274 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-31 19:33:05.197275 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-31 19:33:05.203276 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-31 19:33:05.219276 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-31 19:33:05.260282 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-31 19:33:05.329767 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-31 19:33:05.349765 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-31 19:33:05.394767 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-31 19:33:05.422769 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-31 19:33:05.445767 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-31 19:33:05.469770 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-31 19:33:05.488769 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-31 19:33:05.492767 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-31 19:33:05.511767 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-31 19:33:05.526766 (MainThread): Partial parsing not enabled
2021-05-31 19:33:05.590773 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-05-31 19:33:05.627769 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-05-31 19:33:05.767768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D107DFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D10917400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D109215E0>]}
2021-05-31 19:33:05.768769 (MainThread): Flushing usage events
2021-05-31 19:33:06.533876 (MainThread): Connection 'model.vertica_test_project.stg_school_and_country' was properly closed.
2021-05-31 19:33:06.533876 (MainThread): Encountered an error:
2021-05-31 19:33:06.534879 (MainThread): Compilation Error
  The schema file at staging\schema.yml is invalid because version 1 is not supported. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files
2021-05-31 19:33:06.582877 (MainThread): Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\schemas.py", line 544, in parse_file
    self._parse_format_version(yaml_block)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\schemas.py", line 220, in _parse_format_version
    raise_invalid_schema_yml_version(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 867, in raise_invalid_schema_yml_version
    raise_compiler_error(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at staging\schema.yml is invalid because version 1 is not supported. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files

2021-05-31 19:33:36.306846 (MainThread): Running with dbt=0.18.2
2021-05-31 19:33:36.505922 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 19:33:36.507921 (MainThread): Tracking: tracking
2021-05-31 19:33:36.507921 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3EA8E6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3EB53D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3EB53C10>]}
2021-05-31 19:33:36.550923 (MainThread): Partial parsing not enabled
2021-05-31 19:33:36.553921 (MainThread): Parsing macros\adapters.sql
2021-05-31 19:33:36.599920 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-31 19:33:36.614923 (MainThread): Parsing macros\materializations\seed.sql
2021-05-31 19:33:36.644923 (MainThread): Parsing macros\materializations\table.sql
2021-05-31 19:33:36.660924 (MainThread): Parsing macros\materializations\view.sql
2021-05-31 19:33:36.665926 (MainThread): Parsing macros\core.sql
2021-05-31 19:33:36.673924 (MainThread): Parsing macros\adapters\common.sql
2021-05-31 19:33:36.759923 (MainThread): Parsing macros\etc\datetime.sql
2021-05-31 19:33:36.777927 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-31 19:33:36.780926 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-31 19:33:36.784924 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-31 19:33:36.789924 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-31 19:33:36.792924 (MainThread): Parsing macros\etc\query.sql
2021-05-31 19:33:36.796924 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-31 19:33:36.812924 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-31 19:33:36.838923 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-31 19:33:36.844923 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-31 19:33:36.855926 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-31 19:33:36.895930 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-31 19:33:36.949296 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-31 19:33:36.954367 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-31 19:33:36.990368 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-31 19:33:37.005367 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-31 19:33:37.016366 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-31 19:33:37.027365 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-31 19:33:37.032367 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-31 19:33:37.035367 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-31 19:33:37.040368 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-31 19:33:37.053368 (MainThread): Partial parsing not enabled
2021-05-31 19:33:37.116368 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-05-31 19:33:37.159368 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-05-31 19:33:37.551281 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.staging
- models.marts
- models.test_model
- seeds.test_model.cwurData
- seeds.test_model

2021-05-31 19:33:37.650193 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-05-31 19:33:37.652192 (MainThread): 
2021-05-31 19:33:37.654575 (MainThread): Acquiring new vertica connection "master".
2021-05-31 19:33:37.663112 (ThreadPoolExecutor-0_0): Acquiring new vertica connection "list_docker".
2021-05-31 19:33:37.681110 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker".
2021-05-31 19:33:37.682113 (ThreadPoolExecutor-0_0): On list_docker: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker"} */

    select schema_name
    from v_catalog.schemata
  
2021-05-31 19:33:37.682113 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 19:33:37.725710 (ThreadPoolExecutor-0_0): :P Connected to database: docker at localhost
2021-05-31 19:33:37.833957 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.15 seconds
2021-05-31 19:33:37.840651 (ThreadPoolExecutor-0_0): On list_docker: Close
2021-05-31 19:33:37.868602 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-05-31 19:33:37.877599 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-05-31 19:33:37.877599 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-05-31 19:33:37.877599 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-31 19:33:37.890466 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-05-31 19:33:37.896211 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-05-31 19:33:37.896761 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-05-31 19:33:37.896761 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-05-31 19:33:37.937138 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.04 seconds
2021-05-31 19:33:37.946145 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-05-31 19:33:37.950592 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-05-31 19:33:37.952257 (MainThread): Using vertica connection "master".
2021-05-31 19:33:37.952257 (MainThread): On master: BEGIN
2021-05-31 19:33:37.952844 (MainThread): Opening a new connection, currently in state init
2021-05-31 19:33:37.966997 (MainThread): :P Connected to database: docker at localhost
2021-05-31 19:33:37.970931 (MainThread): SQL status: -1 in 0.02 seconds
2021-05-31 19:33:37.971486 (MainThread): On master: COMMIT
2021-05-31 19:33:37.971486 (MainThread): Using vertica connection "master".
2021-05-31 19:33:37.971486 (MainThread): On master: COMMIT
2021-05-31 19:33:37.976445 (MainThread): SQL status: -1 in 0.00 seconds
2021-05-31 19:33:37.976507 (MainThread): On master: Close
2021-05-31 19:33:37.977623 (MainThread): 23:33:37 | Concurrency: 1 threads (target='dev')
2021-05-31 19:33:37.978234 (MainThread): 23:33:37 | 
2021-05-31 19:33:38.006364 (Thread-1): Began running node model.vertica_test_project.stg_cwurdata
2021-05-31 19:33:38.008365 (Thread-1): 23:33:38 | 1 of 2 START view model dbt_schema.stg_cwurdata...................... [RUN]
2021-05-31 19:33:38.009365 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-05-31 19:33:38.010416 (Thread-1): Compiling model.vertica_test_project.stg_cwurdata
2021-05-31 19:33:38.046364 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_cwurdata"
2021-05-31 19:33:38.051364 (Thread-1): finished collecting timing info
2021-05-31 19:33:38.090364 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_cwurdata"
2021-05-31 19:33:38.094365 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-05-31 19:33:38.094365 (Thread-1): On model.vertica_test_project.stg_cwurdata: BEGIN
2021-05-31 19:33:38.094365 (Thread-1): Opening a new connection, currently in state init
2021-05-31 19:33:38.106230 (Thread-1): :P Connected to database: docker at localhost
2021-05-31 19:33:38.110176 (Thread-1): SQL status: -1 in 0.02 seconds
2021-05-31 19:33:38.110721 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-05-31 19:33:38.110721 (Thread-1): On model.vertica_test_project.stg_cwurdata: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_cwurdata"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_cwurdata" as (
    select
  world_rank,
  institution,
  country,
  national_rank,
  quality_of_education,
  alumni_employment,
  quality_of_faculty,
  publications,
  influence,
  citations,
  broad_impact,
  patents,score,
  year
from "docker"."dbt_schema"."cwurData"
  );


2021-05-31 19:33:38.154167 (Thread-1): SQL status: -1 in 0.04 seconds
2021-05-31 19:33:38.155924 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-05-31 19:33:38.156493 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-05-31 19:33:38.156493 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-05-31 19:33:38.161553 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-31 19:33:38.166282 (Thread-1): finished collecting timing info
2021-05-31 19:33:38.166282 (Thread-1): On model.vertica_test_project.stg_cwurdata: Close
2021-05-31 19:33:38.167989 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b0214a7-3944-4d1c-99c4-bf6e7188d52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3ECCA640>]}
2021-05-31 19:33:38.170413 (Thread-1): 23:33:38 | 1 of 2 OK created view model dbt_schema.stg_cwurdata................. [-1 in 0.16s]
2021-05-31 19:33:38.172092 (Thread-1): Finished running node model.vertica_test_project.stg_cwurdata
2021-05-31 19:33:38.172620 (Thread-1): Began running node model.vertica_test_project.stg_school_and_country
2021-05-31 19:33:38.174607 (Thread-1): 23:33:38 | 2 of 2 START view model dbt_schema.stg_school_and_country............ [RUN]
2021-05-31 19:33:38.176627 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-05-31 19:33:38.176627 (Thread-1): Compiling model.vertica_test_project.stg_school_and_country
2021-05-31 19:33:38.190610 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_school_and_country"
2021-05-31 19:33:38.194633 (Thread-1): finished collecting timing info
2021-05-31 19:33:38.200609 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_school_and_country"
2021-05-31 19:33:38.202608 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-05-31 19:33:38.203608 (Thread-1): On model.vertica_test_project.stg_school_and_country: BEGIN
2021-05-31 19:33:38.203608 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 19:33:38.214850 (Thread-1): :P Connected to database: docker at localhost
2021-05-31 19:33:38.218824 (Thread-1): SQL status: -1 in 0.02 seconds
2021-05-31 19:33:38.219390 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-05-31 19:33:38.219390 (Thread-1): On model.vertica_test_project.stg_school_and_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_school_and_country"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_school_and_country" as (
    select
	school_name,
	country 
from "docker"."dbt_schema"."school_and_country_table"
  );


2021-05-31 19:33:38.230739 (Thread-1): SQL status: -1 in 0.01 seconds
2021-05-31 19:33:38.232259 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-05-31 19:33:38.233259 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-05-31 19:33:38.233259 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-05-31 19:33:38.237374 (Thread-1): SQL status: -1 in 0.00 seconds
2021-05-31 19:33:38.240735 (Thread-1): finished collecting timing info
2021-05-31 19:33:38.241276 (Thread-1): On model.vertica_test_project.stg_school_and_country: Close
2021-05-31 19:33:38.243230 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b0214a7-3944-4d1c-99c4-bf6e7188d52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3EDE7490>]}
2021-05-31 19:33:38.245571 (Thread-1): 23:33:38 | 2 of 2 OK created view model dbt_schema.stg_school_and_country....... [-1 in 0.07s]
2021-05-31 19:33:38.246659 (Thread-1): Finished running node model.vertica_test_project.stg_school_and_country
2021-05-31 19:33:38.248992 (MainThread): Acquiring new vertica connection "master".
2021-05-31 19:33:38.248992 (MainThread): Using vertica connection "master".
2021-05-31 19:33:38.249497 (MainThread): On master: BEGIN
2021-05-31 19:33:38.249551 (MainThread): Opening a new connection, currently in state closed
2021-05-31 19:33:38.263695 (MainThread): :P Connected to database: docker at localhost
2021-05-31 19:33:38.267586 (MainThread): SQL status: -1 in 0.02 seconds
2021-05-31 19:33:38.268135 (MainThread): On master: COMMIT
2021-05-31 19:33:38.268135 (MainThread): Using vertica connection "master".
2021-05-31 19:33:38.268682 (MainThread): On master: COMMIT
2021-05-31 19:33:38.272590 (MainThread): SQL status: -1 in 0.00 seconds
2021-05-31 19:33:38.273137 (MainThread): On master: Close
2021-05-31 19:33:38.274388 (MainThread): 23:33:38 | 
2021-05-31 19:33:38.275443 (MainThread): 23:33:38 | Finished running 2 view models in 0.62s.
2021-05-31 19:33:38.277877 (MainThread): Connection 'master' was properly closed.
2021-05-31 19:33:38.278429 (MainThread): Connection 'list_docker' was properly closed.
2021-05-31 19:33:38.278429 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-05-31 19:33:38.278429 (MainThread): Connection 'model.vertica_test_project.stg_school_and_country' was properly closed.
2021-05-31 19:33:38.290929 (MainThread): 
2021-05-31 19:33:38.291931 (MainThread): Completed successfully
2021-05-31 19:33:38.296928 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-31 19:33:38.298932 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3ED67A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3ED678B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3ED32A30>]}
2021-05-31 19:33:38.298932 (MainThread): Flushing usage events
2021-06-06 16:32:57.678927 (MainThread): Running with dbt=0.18.2
2021-06-06 16:32:58.418825 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 16:32:58.420827 (MainThread): Tracking: tracking
2021-06-06 16:32:58.420827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FDF8F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE055490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE0552E0>]}
2021-06-06 16:32:58.464825 (MainThread): Partial parsing not enabled
2021-06-06 16:32:58.468827 (MainThread): Parsing macros\adapters.sql
2021-06-06 16:32:58.527513 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 16:32:58.542109 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 16:32:58.573105 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 16:32:58.585108 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 16:32:58.612142 (MainThread): Parsing macros\core.sql
2021-06-06 16:32:58.623804 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 16:32:58.713673 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 16:32:58.745462 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 16:32:58.749430 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 16:32:58.770468 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 16:32:58.774469 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 16:32:58.778470 (MainThread): Parsing macros\etc\query.sql
2021-06-06 16:32:58.795469 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 16:32:58.816467 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 16:32:58.859468 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 16:32:58.864471 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 16:32:58.882468 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 16:32:58.925471 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 16:32:58.987469 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 16:32:59.007470 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 16:32:59.047487 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 16:32:59.058481 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 16:32:59.068483 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 16:32:59.079480 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 16:32:59.085490 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 16:32:59.088486 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 16:32:59.109483 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 16:32:59.126164 (MainThread): Partial parsing not enabled
2021-06-06 16:32:59.194678 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:32:59.233680 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:32:59.269052 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:32:59.286070 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:32:59.841312 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.staging
- models.marts
- models.test_model
- seeds.test_model.cwurData
- seeds.test_model

2021-06-06 16:32:59.949346 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 16:32:59.951307 (MainThread): 
2021-06-06 16:32:59.952313 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:32:59.967324 (ThreadPoolExecutor-0_0): Acquiring new vertica connection "list_docker".
2021-06-06 16:32:59.986314 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker".
2021-06-06 16:32:59.986314 (ThreadPoolExecutor-0_0): On list_docker: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker"} */

    select schema_name
    from v_catalog.schemata
  
2021-06-06 16:32:59.986314 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 16:33:00.059451 (ThreadPoolExecutor-0_0): :P Connected to database: docker at localhost
2021-06-06 16:33:00.105166 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.12 seconds
2021-06-06 16:33:00.111729 (ThreadPoolExecutor-0_0): On list_docker: Close
2021-06-06 16:33:00.146782 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 16:33:00.156782 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:33:00.156782 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 16:33:00.156782 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 16:33:00.169815 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 16:33:00.175851 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.175851 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:33:00.176396 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 16:33:00.196841 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.206837 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 16:33:00.210839 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 16:33:00.212845 (MainThread): Using vertica connection "master".
2021-06-06 16:33:00.213838 (MainThread): On master: BEGIN
2021-06-06 16:33:00.213838 (MainThread): Opening a new connection, currently in state init
2021-06-06 16:33:00.226838 (MainThread): :P Connected to database: docker at localhost
2021-06-06 16:33:00.230577 (MainThread): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.231138 (MainThread): On master: COMMIT
2021-06-06 16:33:00.231138 (MainThread): Using vertica connection "master".
2021-06-06 16:33:00.231138 (MainThread): On master: COMMIT
2021-06-06 16:33:00.236188 (MainThread): SQL status: -1 in 0.00 seconds
2021-06-06 16:33:00.236188 (MainThread): On master: Close
2021-06-06 16:33:00.237361 (MainThread): 20:33:00 | Concurrency: 1 threads (target='dev')
2021-06-06 16:33:00.237918 (MainThread): 20:33:00 | 
2021-06-06 16:33:00.259767 (Thread-1): Began running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:33:00.262590 (Thread-1): 20:33:00 | 1 of 4 START view model dbt_schema.mrt_country_of_university_percent. [RUN]
2021-06-06 16:33:00.263159 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:33:00.263727 (Thread-1): Compiling model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:33:00.310464 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_of_university_percent"
2021-06-06 16:33:00.313466 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.355466 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.mrt_country_of_university_percent"
2021-06-06 16:33:00.358471 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:33:00.359469 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: BEGIN
2021-06-06 16:33:00.359469 (Thread-1): Opening a new connection, currently in state init
2021-06-06 16:33:00.372660 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:33:00.377225 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.377771 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:33:00.377771 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */

  

  
  create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (
    select 
country, round(cnt/cnt_all * 100, 2) as per
FROM
(
SELECT country,
     count(distinct institution) as cnt          
from "docker"."dbt_schema"."cwurData"
GROUP BY country) t1,
(select count(distinct institution) as cnt_all from 
(select count(*) as cnt_all from "docker"."dbt_schema"."cwurData") t2
order by cnt desc
  );


2021-06-06 16:33:00.385148 (Thread-1): :P Database error: Severity: ERROR, Message: Subquery in FROM must have an alias, Sqlstate: 42601, Hint: For example, FROM (SELECT ...) [AS] foo, Routine: base_yyparse, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/gram.y, Line: 12542, Error Code: 4833, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from  (select count(*) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc   ); '
2021-06-06 16:33:00.385210 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: ROLLBACK
2021-06-06 16:33:00.389614 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: Close
2021-06-06 16:33:00.390787 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.391891 (Thread-1): Database Error in model mrt_country_of_university_percent (models\marts\mrt_country_of_university_percent.sql)
  Severity: ERROR, Message: Subquery in FROM must have an alias, Sqlstate: 42601, Hint: For example, FROM (SELECT ...) [AS] foo, Routine: base_yyparse, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/gram.y, Line: 12542, Error Code: 4833, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from  (select count(*) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc   ); '
  compiled SQL at target\run\vertica_test_project\models\marts\mrt_country_of_university_percent.sql
Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 97, in exception_handler
    yield
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 222, in execute
    self._execute_simple_query(operation)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 606, in _execute_simple_query
    raise errors.QueryError.from_error_response(self._message, query)
vertica_python.errors.VerticaSyntaxError: Severity: ERROR, Message: Subquery in FROM must have an alias, Sqlstate: 42601, Hint: For example, FROM (SELECT ...) [AS] foo, Routine: base_yyparse, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/gram.y, Line: 12542, Error Code: 4833, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from  (select count(*) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc   ); '

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\programdata\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 101, in exception_handler
    raise dbt.exceptions.DatabaseException(str(exc))
dbt.exceptions.DatabaseException: Database Error in model mrt_country_of_university_percent (models\marts\mrt_country_of_university_percent.sql)
  Severity: ERROR, Message: Subquery in FROM must have an alias, Sqlstate: 42601, Hint: For example, FROM (SELECT ...) [AS] foo, Routine: base_yyparse, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/gram.y, Line: 12542, Error Code: 4833, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from  (select count(*) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc   ); '
  compiled SQL at target\run\vertica_test_project\models\marts\mrt_country_of_university_percent.sql
2021-06-06 16:33:00.539592 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bfeaecf-5adb-44d9-933a-8bfd870260bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE421730>]}
2021-06-06 16:33:00.541594 (Thread-1): 20:33:00 | 1 of 4 ERROR creating view model dbt_schema.mrt_country_of_university_percent [ERROR in 0.28s]
2021-06-06 16:33:00.542594 (Thread-1): Finished running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:33:00.542594 (Thread-1): Began running node model.vertica_test_project.mrt_country_percent
2021-06-06 16:33:00.544600 (Thread-1): 20:33:00 | 2 of 4 START view model dbt_schema.mrt_country_percent............... [RUN]
2021-06-06 16:33:00.545596 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:33:00.546592 (Thread-1): Compiling model.vertica_test_project.mrt_country_percent
2021-06-06 16:33:00.574595 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_percent"
2021-06-06 16:33:00.575592 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.583595 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.mrt_country_percent"
2021-06-06 16:33:00.586595 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:33:00.586595 (Thread-1): On model.vertica_test_project.mrt_country_percent: BEGIN
2021-06-06 16:33:00.586595 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:33:00.599052 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:33:00.604153 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.604153 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:33:00.604153 (Thread-1): On model.vertica_test_project.mrt_country_percent: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_percent"} */

  

  
  create or replace view "docker"."dbt_schema"."mrt_country_percent" as (
    select country, round(cnt/cnt_all * 100, 2) as per
from
(SELECT country,
     count(*) as cnt          
from "docker"."dbt_schema"."school_and_country_table"
GROUP BY country) t1,
(select count(*) as cnt_all from "docker"."dbt_schema"."school_and_country_table") t2
order by cnt desc
  );


2021-06-06 16:33:00.637748 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:33:00.639407 (Thread-1): On model.vertica_test_project.mrt_country_percent: COMMIT
2021-06-06 16:33:00.640006 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:33:00.640006 (Thread-1): On model.vertica_test_project.mrt_country_percent: COMMIT
2021-06-06 16:33:00.643913 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:33:00.646716 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.647280 (Thread-1): On model.vertica_test_project.mrt_country_percent: Close
2021-06-06 16:33:00.649577 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bfeaecf-5adb-44d9-933a-8bfd870260bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE4456A0>]}
2021-06-06 16:33:00.652753 (Thread-1): 20:33:00 | 2 of 4 OK created view model dbt_schema.mrt_country_percent.......... [-1 in 0.10s]
2021-06-06 16:33:00.653832 (Thread-1): Finished running node model.vertica_test_project.mrt_country_percent
2021-06-06 16:33:00.654381 (Thread-1): Began running node model.vertica_test_project.stg_cwurdata
2021-06-06 16:33:00.655900 (Thread-1): 20:33:00 | 3 of 4 START view model dbt_schema.stg_cwurdata...................... [RUN]
2021-06-06 16:33:00.656898 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:33:00.656898 (Thread-1): Compiling model.vertica_test_project.stg_cwurdata
2021-06-06 16:33:00.677899 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_cwurdata"
2021-06-06 16:33:00.680900 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.688898 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_cwurdata"
2021-06-06 16:33:00.690902 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:33:00.690902 (Thread-1): On model.vertica_test_project.stg_cwurdata: BEGIN
2021-06-06 16:33:00.691901 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:33:00.704439 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:33:00.708281 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.708346 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:33:00.708346 (Thread-1): On model.vertica_test_project.stg_cwurdata: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_cwurdata"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_cwurdata" as (
    select
  world_rank,
  institution,
  country,
  national_rank,
  quality_of_education,
  alumni_employment,
  quality_of_faculty,
  publications,
  influence,
  citations,
  broad_impact,
  patents,score,
  year
from "docker"."dbt_schema"."cwurData"
  );


2021-06-06 16:33:00.724252 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.725921 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-06-06 16:33:00.726477 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:33:00.726477 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-06-06 16:33:00.730356 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:33:00.733113 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.733670 (Thread-1): On model.vertica_test_project.stg_cwurdata: Close
2021-06-06 16:33:00.735375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bfeaecf-5adb-44d9-933a-8bfd870260bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE431670>]}
2021-06-06 16:33:00.737757 (Thread-1): 20:33:00 | 3 of 4 OK created view model dbt_schema.stg_cwurdata................. [-1 in 0.08s]
2021-06-06 16:33:00.738846 (Thread-1): Finished running node model.vertica_test_project.stg_cwurdata
2021-06-06 16:33:00.739398 (Thread-1): Began running node model.vertica_test_project.stg_school_and_country
2021-06-06 16:33:00.741023 (Thread-1): 20:33:00 | 4 of 4 START view model dbt_schema.stg_school_and_country............ [RUN]
2021-06-06 16:33:00.742105 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:33:00.742653 (Thread-1): Compiling model.vertica_test_project.stg_school_and_country
2021-06-06 16:33:00.762391 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_school_and_country"
2021-06-06 16:33:00.765798 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.774885 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_school_and_country"
2021-06-06 16:33:00.776485 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:33:00.776485 (Thread-1): On model.vertica_test_project.stg_school_and_country: BEGIN
2021-06-06 16:33:00.776485 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:33:00.787272 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:33:00.791113 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:33:00.791113 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:33:00.791113 (Thread-1): On model.vertica_test_project.stg_school_and_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_school_and_country"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_school_and_country" as (
    select
	school_name,
	country 
from "docker"."dbt_schema"."school_and_country_table"
  );


2021-06-06 16:33:00.801860 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:33:00.803489 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-06-06 16:33:00.803489 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:33:00.804011 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-06-06 16:33:00.807574 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:33:00.810919 (Thread-1): finished collecting timing info
2021-06-06 16:33:00.811481 (Thread-1): On model.vertica_test_project.stg_school_and_country: Close
2021-06-06 16:33:00.813127 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bfeaecf-5adb-44d9-933a-8bfd870260bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE4A4910>]}
2021-06-06 16:33:00.816507 (Thread-1): 20:33:00 | 4 of 4 OK created view model dbt_schema.stg_school_and_country....... [-1 in 0.07s]
2021-06-06 16:33:00.818136 (Thread-1): Finished running node model.vertica_test_project.stg_school_and_country
2021-06-06 16:33:00.820031 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:33:00.820618 (MainThread): Using vertica connection "master".
2021-06-06 16:33:00.820618 (MainThread): On master: BEGIN
2021-06-06 16:33:00.820618 (MainThread): Opening a new connection, currently in state closed
2021-06-06 16:33:00.835466 (MainThread): :P Connected to database: docker at localhost
2021-06-06 16:33:00.842280 (MainThread): SQL status: -1 in 0.02 seconds
2021-06-06 16:33:00.842280 (MainThread): On master: COMMIT
2021-06-06 16:33:00.842827 (MainThread): Using vertica connection "master".
2021-06-06 16:33:00.842827 (MainThread): On master: COMMIT
2021-06-06 16:33:00.847259 (MainThread): SQL status: -1 in 0.00 seconds
2021-06-06 16:33:00.847822 (MainThread): On master: Close
2021-06-06 16:33:00.848935 (MainThread): 20:33:00 | 
2021-06-06 16:33:00.849486 (MainThread): 20:33:00 | Finished running 4 view models in 0.90s.
2021-06-06 16:33:00.856432 (MainThread): Connection 'master' was properly closed.
2021-06-06 16:33:00.857005 (MainThread): Connection 'list_docker' was properly closed.
2021-06-06 16:33:00.857005 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 16:33:00.857578 (MainThread): Connection 'model.vertica_test_project.stg_school_and_country' was properly closed.
2021-06-06 16:33:00.887974 (MainThread): 
2021-06-06 16:33:00.887974 (MainThread): Completed with 1 error and 0 warnings:
2021-06-06 16:33:00.890972 (MainThread): 
2021-06-06 16:33:00.897971 (MainThread): Database Error in model mrt_country_of_university_percent (models\marts\mrt_country_of_university_percent.sql)
2021-06-06 16:33:00.904969 (MainThread):   Severity: ERROR, Message: Subquery in FROM must have an alias, Sqlstate: 42601, Hint: For example, FROM (SELECT ...) [AS] foo, Routine: base_yyparse, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/gram.y, Line: 12542, Error Code: 4833, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from  (select count(*) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc   ); '
2021-06-06 16:33:00.911969 (MainThread):   compiled SQL at target\run\vertica_test_project\models\marts\mrt_country_of_university_percent.sql
2021-06-06 16:33:00.912974 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-06-06 16:33:00.919993 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE09B4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE4570D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174FE457070>]}
2021-06-06 16:33:00.920975 (MainThread): Flushing usage events
2021-06-06 16:35:13.732985 (MainThread): Running with dbt=0.18.2
2021-06-06 16:35:13.923836 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 16:35:13.924982 (MainThread): Tracking: tracking
2021-06-06 16:35:13.925577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECD783130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEC9CE70A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECD79B070>]}
2021-06-06 16:35:13.957443 (MainThread): Partial parsing not enabled
2021-06-06 16:35:13.959406 (MainThread): Parsing macros\adapters.sql
2021-06-06 16:35:14.001412 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 16:35:14.011412 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 16:35:14.038763 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 16:35:14.051759 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 16:35:14.056758 (MainThread): Parsing macros\core.sql
2021-06-06 16:35:14.064202 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 16:35:14.145830 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 16:35:14.160815 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 16:35:14.163820 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 16:35:14.168352 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 16:35:14.172193 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 16:35:14.175598 (MainThread): Parsing macros\etc\query.sql
2021-06-06 16:35:14.177239 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 16:35:14.192234 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 16:35:14.219252 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 16:35:14.223251 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 16:35:14.234245 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 16:35:14.274248 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 16:35:14.325118 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 16:35:14.329126 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 16:35:14.366128 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 16:35:14.378122 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 16:35:14.386703 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 16:35:14.401705 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 16:35:14.408706 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 16:35:14.411708 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 16:35:14.415718 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 16:35:14.427709 (MainThread): Partial parsing not enabled
2021-06-06 16:35:14.480744 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:35:14.512710 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:35:14.529713 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:35:14.548714 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:35:14.881187 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.marts
- models.test_model
- models.staging
- seeds.test_model
- seeds.test_model.cwurData

2021-06-06 16:35:14.978186 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 16:35:14.980197 (MainThread): 
2021-06-06 16:35:14.982192 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:35:14.992189 (ThreadPoolExecutor-0_0): Acquiring new vertica connection "list_docker".
2021-06-06 16:35:15.009191 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker".
2021-06-06 16:35:15.009191 (ThreadPoolExecutor-0_0): On list_docker: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker"} */

    select schema_name
    from v_catalog.schemata
  
2021-06-06 16:35:15.010222 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 16:35:15.036089 (ThreadPoolExecutor-0_0): :P Connected to database: docker at localhost
2021-06-06 16:35:15.066190 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.06 seconds
2021-06-06 16:35:15.070524 (ThreadPoolExecutor-0_0): On list_docker: Close
2021-06-06 16:35:15.104672 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 16:35:15.114675 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:35:15.114675 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 16:35:15.114675 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 16:35:15.126315 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 16:35:15.131866 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:35:15.131866 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:35:15.132397 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 16:35:15.155272 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:35:15.164273 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 16:35:15.168831 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 16:35:15.171021 (MainThread): Using vertica connection "master".
2021-06-06 16:35:15.171021 (MainThread): On master: BEGIN
2021-06-06 16:35:15.171606 (MainThread): Opening a new connection, currently in state init
2021-06-06 16:35:15.184477 (MainThread): :P Connected to database: docker at localhost
2021-06-06 16:35:15.188479 (MainThread): SQL status: -1 in 0.02 seconds
2021-06-06 16:35:15.189035 (MainThread): On master: COMMIT
2021-06-06 16:35:15.189035 (MainThread): Using vertica connection "master".
2021-06-06 16:35:15.189035 (MainThread): On master: COMMIT
2021-06-06 16:35:15.193497 (MainThread): SQL status: -1 in 0.00 seconds
2021-06-06 16:35:15.193497 (MainThread): On master: Close
2021-06-06 16:35:15.194588 (MainThread): 20:35:15 | Concurrency: 1 threads (target='dev')
2021-06-06 16:35:15.195140 (MainThread): 20:35:15 | 
2021-06-06 16:35:15.214085 (Thread-1): Began running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:35:15.218077 (Thread-1): 20:35:15 | 1 of 4 START view model dbt_schema.mrt_country_of_university_percent. [RUN]
2021-06-06 16:35:15.220077 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:35:15.220077 (Thread-1): Compiling model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:35:15.262078 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_of_university_percent"
2021-06-06 16:35:15.264078 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.306819 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.mrt_country_of_university_percent"
2021-06-06 16:35:15.308457 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:35:15.308966 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: BEGIN
2021-06-06 16:35:15.309019 (Thread-1): Opening a new connection, currently in state init
2021-06-06 16:35:15.318454 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:35:15.322305 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:35:15.322305 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:35:15.322852 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */

  

  
  create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (
    select 
country, round(cnt/cnt_all * 100, 2) as per
FROM
(
SELECT country,
     count(distinct institution) as cnt          
from "docker"."dbt_schema"."cwurData"
GROUP BY country) t1,
(select count(distinct institution) as cnt_all from "docker"."dbt_schema"."cwurData") t2
order by cnt desc
)
  );


2021-06-06 16:35:15.326176 (Thread-1): :P Database error: Severity: ERROR, Message: Syntax error at or near ")", Sqlstate: 42601, Position: 580, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc )   ); '
2021-06-06 16:35:15.326176 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: ROLLBACK
2021-06-06 16:35:15.330053 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: Close
2021-06-06 16:35:15.330608 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.331696 (Thread-1): Database Error in model mrt_country_of_university_percent (models\marts\mrt_country_of_university_percent.sql)
  Severity: ERROR, Message: Syntax error at or near ")", Sqlstate: 42601, Position: 580, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc )   ); '
  compiled SQL at target\run\vertica_test_project\models\marts\mrt_country_of_university_percent.sql
Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 97, in exception_handler
    yield
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 222, in execute
    self._execute_simple_query(operation)
  File "c:\programdata\anaconda3\lib\site-packages\vertica_python\vertica\cursor.py", line 606, in _execute_simple_query
    raise errors.QueryError.from_error_response(self._message, query)
vertica_python.errors.VerticaSyntaxError: Severity: ERROR, Message: Syntax error at or near ")", Sqlstate: 42601, Position: 580, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc )   ); '

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\programdata\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\adapters\vertica\connections.py", line 101, in exception_handler
    raise dbt.exceptions.DatabaseException(str(exc))
dbt.exceptions.DatabaseException: Database Error in model mrt_country_of_university_percent (models\marts\mrt_country_of_university_percent.sql)
  Severity: ERROR, Message: Syntax error at or near ")", Sqlstate: 42601, Position: 580, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc )   ); '
  compiled SQL at target\run\vertica_test_project\models\marts\mrt_country_of_university_percent.sql
2021-06-06 16:35:15.340558 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65053b24-e42e-44bb-ad78-3eb8bebb411f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDBBD8B0>]}
2021-06-06 16:35:15.342750 (Thread-1): 20:35:15 | 1 of 4 ERROR creating view model dbt_schema.mrt_country_of_university_percent [ERROR in 0.12s]
2021-06-06 16:35:15.343433 (Thread-1): Finished running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:35:15.343989 (Thread-1): Began running node model.vertica_test_project.mrt_country_percent
2021-06-06 16:35:15.345514 (Thread-1): 20:35:15 | 2 of 4 START view model dbt_schema.mrt_country_percent............... [RUN]
2021-06-06 16:35:15.346512 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:35:15.346512 (Thread-1): Compiling model.vertica_test_project.mrt_country_percent
2021-06-06 16:35:15.365513 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_percent"
2021-06-06 16:35:15.367515 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.373507 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.mrt_country_percent"
2021-06-06 16:35:15.375509 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:35:15.375509 (Thread-1): On model.vertica_test_project.mrt_country_percent: BEGIN
2021-06-06 16:35:15.375509 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:35:15.388173 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:35:15.392047 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:35:15.392594 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:35:15.392594 (Thread-1): On model.vertica_test_project.mrt_country_percent: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_percent"} */

  

  
  create or replace view "docker"."dbt_schema"."mrt_country_percent" as (
    select country, round(cnt/cnt_all * 100, 2) as per
from
(SELECT country,
     count(*) as cnt          
from "docker"."dbt_schema"."school_and_country_table"
GROUP BY country) t1,
(select count(*) as cnt_all from "docker"."dbt_schema"."school_and_country_table") t2
order by cnt desc
  );


2021-06-06 16:35:15.405415 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:35:15.407086 (Thread-1): On model.vertica_test_project.mrt_country_percent: COMMIT
2021-06-06 16:35:15.407086 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:35:15.407612 (Thread-1): On model.vertica_test_project.mrt_country_percent: COMMIT
2021-06-06 16:35:15.410495 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:35:15.413243 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.413895 (Thread-1): On model.vertica_test_project.mrt_country_percent: Close
2021-06-06 16:35:15.415539 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65053b24-e42e-44bb-ad78-3eb8bebb411f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDA5C400>]}
2021-06-06 16:35:15.418386 (Thread-1): 20:35:15 | 2 of 4 OK created view model dbt_schema.mrt_country_percent.......... [-1 in 0.07s]
2021-06-06 16:35:15.419492 (Thread-1): Finished running node model.vertica_test_project.mrt_country_percent
2021-06-06 16:35:15.420050 (Thread-1): Began running node model.vertica_test_project.stg_cwurdata
2021-06-06 16:35:15.422804 (Thread-1): 20:35:15 | 3 of 4 START view model dbt_schema.stg_cwurdata...................... [RUN]
2021-06-06 16:35:15.424002 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:35:15.424002 (Thread-1): Compiling model.vertica_test_project.stg_cwurdata
2021-06-06 16:35:15.440594 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_cwurdata"
2021-06-06 16:35:15.443588 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.452588 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_cwurdata"
2021-06-06 16:35:15.453587 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:35:15.453587 (Thread-1): On model.vertica_test_project.stg_cwurdata: BEGIN
2021-06-06 16:35:15.454591 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:35:15.465462 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:35:15.469421 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:35:15.469966 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:35:15.469966 (Thread-1): On model.vertica_test_project.stg_cwurdata: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_cwurdata"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_cwurdata" as (
    select
  world_rank,
  institution,
  country,
  national_rank,
  quality_of_education,
  alumni_employment,
  quality_of_faculty,
  publications,
  influence,
  citations,
  broad_impact,
  patents,score,
  year
from "docker"."dbt_schema"."cwurData"
  );


2021-06-06 16:35:15.484249 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:35:15.486250 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-06-06 16:35:15.486250 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:35:15.486250 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-06-06 16:35:15.490378 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:35:15.493133 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.493706 (Thread-1): On model.vertica_test_project.stg_cwurdata: Close
2021-06-06 16:35:15.495380 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65053b24-e42e-44bb-ad78-3eb8bebb411f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDB985B0>]}
2021-06-06 16:35:15.497635 (Thread-1): 20:35:15 | 3 of 4 OK created view model dbt_schema.stg_cwurdata................. [-1 in 0.07s]
2021-06-06 16:35:15.498712 (Thread-1): Finished running node model.vertica_test_project.stg_cwurdata
2021-06-06 16:35:15.498712 (Thread-1): Began running node model.vertica_test_project.stg_school_and_country
2021-06-06 16:35:15.500924 (Thread-1): 20:35:15 | 4 of 4 START view model dbt_schema.stg_school_and_country............ [RUN]
2021-06-06 16:35:15.501457 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:35:15.502011 (Thread-1): Compiling model.vertica_test_project.stg_school_and_country
2021-06-06 16:35:15.519025 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_school_and_country"
2021-06-06 16:35:15.520026 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.530022 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_school_and_country"
2021-06-06 16:35:15.532025 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:35:15.532025 (Thread-1): On model.vertica_test_project.stg_school_and_country: BEGIN
2021-06-06 16:35:15.532025 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:35:15.544296 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:35:15.548274 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:35:15.548830 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:35:15.548830 (Thread-1): On model.vertica_test_project.stg_school_and_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_school_and_country"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_school_and_country" as (
    select
	school_name,
	country 
from "docker"."dbt_schema"."school_and_country_table"
  );


2021-06-06 16:35:15.560063 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:35:15.561588 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-06-06 16:35:15.561588 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:35:15.562589 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-06-06 16:35:15.565797 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:35:15.569773 (Thread-1): finished collecting timing info
2021-06-06 16:35:15.570323 (Thread-1): On model.vertica_test_project.stg_school_and_country: Close
2021-06-06 16:35:15.572080 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65053b24-e42e-44bb-ad78-3eb8bebb411f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDBD4430>]}
2021-06-06 16:35:15.575060 (Thread-1): 20:35:15 | 4 of 4 OK created view model dbt_schema.stg_school_and_country....... [-1 in 0.07s]
2021-06-06 16:35:15.576141 (Thread-1): Finished running node model.vertica_test_project.stg_school_and_country
2021-06-06 16:35:15.577874 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:35:15.577874 (MainThread): Using vertica connection "master".
2021-06-06 16:35:15.578449 (MainThread): On master: BEGIN
2021-06-06 16:35:15.578449 (MainThread): Opening a new connection, currently in state closed
2021-06-06 16:35:15.590250 (MainThread): :P Connected to database: docker at localhost
2021-06-06 16:35:15.596027 (MainThread): SQL status: -1 in 0.02 seconds
2021-06-06 16:35:15.596579 (MainThread): On master: COMMIT
2021-06-06 16:35:15.596579 (MainThread): Using vertica connection "master".
2021-06-06 16:35:15.596579 (MainThread): On master: COMMIT
2021-06-06 16:35:15.603499 (MainThread): SQL status: -1 in 0.01 seconds
2021-06-06 16:35:15.603499 (MainThread): On master: Close
2021-06-06 16:35:15.604605 (MainThread): 20:35:15 | 
2021-06-06 16:35:15.605734 (MainThread): 20:35:15 | Finished running 4 view models in 0.62s.
2021-06-06 16:35:15.615618 (MainThread): Connection 'master' was properly closed.
2021-06-06 16:35:15.616257 (MainThread): Connection 'list_docker' was properly closed.
2021-06-06 16:35:15.616813 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 16:35:15.616813 (MainThread): Connection 'model.vertica_test_project.stg_school_and_country' was properly closed.
2021-06-06 16:35:15.645542 (MainThread): 
2021-06-06 16:35:15.646523 (MainThread): Completed with 1 error and 0 warnings:
2021-06-06 16:35:15.649518 (MainThread): 
2021-06-06 16:35:15.655536 (MainThread): Database Error in model mrt_country_of_university_percent (models\marts\mrt_country_of_university_percent.sql)
2021-06-06 16:35:15.656517 (MainThread):   Severity: ERROR, Message: Syntax error at or near ")", Sqlstate: 42601, Position: 580, Routine: base_yyerror, File: /scratch_a/release/svrtar12359/vbuild/vertica/Parser/scan.l, Line: 1043, Error Code: 4856, SQL: '/* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */         create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (     select  country, round(cnt/cnt_all * 100, 2) as per FROM ( SELECT country,      count(distinct institution) as cnt           from "docker"."dbt_schema"."cwurData" GROUP BY country) t1, (select count(distinct institution) as cnt_all from "docker"."dbt_schema"."cwurData") t2 order by cnt desc )   ); '
2021-06-06 16:35:15.662528 (MainThread):   compiled SQL at target\run\vertica_test_project\models\marts\mrt_country_of_university_percent.sql
2021-06-06 16:35:15.666517 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-06-06 16:35:15.667520 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDC70DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDAFDA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDBD4430>]}
2021-06-06 16:35:15.668516 (MainThread): Flushing usage events
2021-06-06 16:37:06.682587 (MainThread): Running with dbt=0.18.2
2021-06-06 16:37:06.913544 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 16:37:06.915550 (MainThread): Tracking: tracking
2021-06-06 16:37:06.915550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF604BFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60583BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60583FD0>]}
2021-06-06 16:37:06.979782 (MainThread): Partial parsing not enabled
2021-06-06 16:37:06.982784 (MainThread): Parsing macros\adapters.sql
2021-06-06 16:37:07.043686 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 16:37:07.059542 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 16:37:07.093115 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 16:37:07.106816 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 16:37:07.116262 (MainThread): Parsing macros\core.sql
2021-06-06 16:37:07.125661 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 16:37:07.257821 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 16:37:07.282829 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 16:37:07.285825 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 16:37:07.292825 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 16:37:07.303829 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 16:37:07.309828 (MainThread): Parsing macros\etc\query.sql
2021-06-06 16:37:07.313952 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 16:37:07.341845 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 16:37:07.377493 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 16:37:07.383494 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 16:37:07.402496 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 16:37:07.461507 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 16:37:07.532920 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 16:37:07.538922 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 16:37:07.585924 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 16:37:07.601924 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 16:37:07.613925 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 16:37:07.630404 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 16:37:07.637509 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 16:37:07.640666 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 16:37:07.646667 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 16:37:07.666666 (MainThread): Partial parsing not enabled
2021-06-06 16:37:07.740672 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:37:07.786026 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:37:07.808030 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:37:07.830032 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:37:08.308913 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.staging
- models.marts
- models.test_model
- seeds.test_model.cwurData
- seeds.test_model

2021-06-06 16:37:08.450709 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 16:37:08.453291 (MainThread): 
2021-06-06 16:37:08.455358 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:37:08.468965 (ThreadPoolExecutor-0_0): Acquiring new vertica connection "list_docker".
2021-06-06 16:37:08.491945 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker".
2021-06-06 16:37:08.491945 (ThreadPoolExecutor-0_0): On list_docker: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker"} */

    select schema_name
    from v_catalog.schemata
  
2021-06-06 16:37:08.491945 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 16:37:08.522706 (ThreadPoolExecutor-0_0): :P Connected to database: docker at localhost
2021-06-06 16:37:08.561161 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.07 seconds
2021-06-06 16:37:08.565490 (ThreadPoolExecutor-0_0): On list_docker: Close
2021-06-06 16:37:08.608292 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 16:37:08.620289 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:37:08.621290 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 16:37:08.621290 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 16:37:08.632873 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 16:37:08.637353 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:37:08.637905 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:37:08.637905 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 16:37:08.661829 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:37:08.674215 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 16:37:08.679602 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 16:37:08.681537 (MainThread): Using vertica connection "master".
2021-06-06 16:37:08.682105 (MainThread): On master: BEGIN
2021-06-06 16:37:08.682852 (MainThread): Opening a new connection, currently in state init
2021-06-06 16:37:08.693466 (MainThread): :P Connected to database: docker at localhost
2021-06-06 16:37:08.697309 (MainThread): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:08.697309 (MainThread): On master: COMMIT
2021-06-06 16:37:08.697309 (MainThread): Using vertica connection "master".
2021-06-06 16:37:08.697849 (MainThread): On master: COMMIT
2021-06-06 16:37:08.701709 (MainThread): SQL status: -1 in 0.00 seconds
2021-06-06 16:37:08.701709 (MainThread): On master: Close
2021-06-06 16:37:08.702809 (MainThread): 20:37:08 | Concurrency: 1 threads (target='dev')
2021-06-06 16:37:08.703464 (MainThread): 20:37:08 | 
2021-06-06 16:37:08.716943 (Thread-1): Began running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:37:08.718954 (Thread-1): 20:37:08 | 1 of 4 START view model dbt_schema.mrt_country_of_university_percent. [RUN]
2021-06-06 16:37:08.718954 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:37:08.719956 (Thread-1): Compiling model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:37:08.760159 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_of_university_percent"
2021-06-06 16:37:08.762255 (Thread-1): finished collecting timing info
2021-06-06 16:37:08.797246 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.mrt_country_of_university_percent"
2021-06-06 16:37:08.798244 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:37:08.798244 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: BEGIN
2021-06-06 16:37:08.798244 (Thread-1): Opening a new connection, currently in state init
2021-06-06 16:37:08.808573 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:37:08.812413 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:08.812957 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:37:08.812957 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_of_university_percent"} */

  

  
  create or replace view "docker"."dbt_schema"."mrt_country_of_university_percent" as (
    select 
country, round(cnt/cnt_all * 100, 2) as per
FROM
(
SELECT country,
     count(distinct institution) as cnt          
from "docker"."dbt_schema"."cwurData"
GROUP BY country) t1,
(select count(distinct institution) as cnt_all from "docker"."dbt_schema"."cwurData") t2
order by cnt desc
  );


2021-06-06 16:37:08.826651 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:08.828424 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: COMMIT
2021-06-06 16:37:08.828424 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:37:08.828424 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: COMMIT
2021-06-06 16:37:08.832986 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:37:08.835740 (Thread-1): finished collecting timing info
2021-06-06 16:37:08.836292 (Thread-1): On model.vertica_test_project.mrt_country_of_university_percent: Close
2021-06-06 16:37:08.837928 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63489567-9f98-4285-a07c-8d53b3fd944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF6097C4C0>]}
2021-06-06 16:37:08.841048 (Thread-1): 20:37:08 | 1 of 4 OK created view model dbt_schema.mrt_country_of_university_percent [-1 in 0.12s]
2021-06-06 16:37:08.842753 (Thread-1): Finished running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 16:37:08.843298 (Thread-1): Began running node model.vertica_test_project.mrt_country_percent
2021-06-06 16:37:08.845522 (Thread-1): 20:37:08 | 2 of 4 START view model dbt_schema.mrt_country_percent............... [RUN]
2021-06-06 16:37:08.846627 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:37:08.847168 (Thread-1): Compiling model.vertica_test_project.mrt_country_percent
2021-06-06 16:37:08.864857 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_percent"
2021-06-06 16:37:08.866894 (Thread-1): finished collecting timing info
2021-06-06 16:37:08.872849 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.mrt_country_percent"
2021-06-06 16:37:08.874859 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:37:08.875851 (Thread-1): On model.vertica_test_project.mrt_country_percent: BEGIN
2021-06-06 16:37:08.875851 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:37:08.887177 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:37:08.890453 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:08.891019 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:37:08.891030 (Thread-1): On model.vertica_test_project.mrt_country_percent: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.mrt_country_percent"} */

  

  
  create or replace view "docker"."dbt_schema"."mrt_country_percent" as (
    select country, round(cnt/cnt_all * 100, 2) as per
from
(SELECT country,
     count(*) as cnt          
from "docker"."dbt_schema"."school_and_country_table"
GROUP BY country) t1,
(select count(*) as cnt_all from "docker"."dbt_schema"."school_and_country_table") t2
order by cnt desc
  );


2021-06-06 16:37:08.905649 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:08.907618 (Thread-1): On model.vertica_test_project.mrt_country_percent: COMMIT
2021-06-06 16:37:08.908184 (Thread-1): Using vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:37:08.908184 (Thread-1): On model.vertica_test_project.mrt_country_percent: COMMIT
2021-06-06 16:37:08.913152 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:37:08.915869 (Thread-1): finished collecting timing info
2021-06-06 16:37:08.916548 (Thread-1): On model.vertica_test_project.mrt_country_percent: Close
2021-06-06 16:37:08.918245 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63489567-9f98-4285-a07c-8d53b3fd944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF609A2BB0>]}
2021-06-06 16:37:08.920989 (Thread-1): 20:37:08 | 2 of 4 OK created view model dbt_schema.mrt_country_percent.......... [-1 in 0.07s]
2021-06-06 16:37:08.922113 (Thread-1): Finished running node model.vertica_test_project.mrt_country_percent
2021-06-06 16:37:08.922681 (Thread-1): Began running node model.vertica_test_project.stg_cwurdata
2021-06-06 16:37:08.924370 (Thread-1): 20:37:08 | 3 of 4 START view model dbt_schema.stg_cwurdata...................... [RUN]
2021-06-06 16:37:08.925483 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:37:08.926080 (Thread-1): Compiling model.vertica_test_project.stg_cwurdata
2021-06-06 16:37:08.953780 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_cwurdata"
2021-06-06 16:37:08.955769 (Thread-1): finished collecting timing info
2021-06-06 16:37:08.967886 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_cwurdata"
2021-06-06 16:37:08.968888 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:37:08.968888 (Thread-1): On model.vertica_test_project.stg_cwurdata: BEGIN
2021-06-06 16:37:08.969888 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:37:08.981374 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:37:08.985439 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:37:08.985439 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:37:08.985979 (Thread-1): On model.vertica_test_project.stg_cwurdata: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_cwurdata"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_cwurdata" as (
    select
  world_rank,
  institution,
  country,
  national_rank,
  quality_of_education,
  alumni_employment,
  quality_of_faculty,
  publications,
  influence,
  citations,
  broad_impact,
  patents,score,
  year
from "docker"."dbt_schema"."cwurData"
  );


2021-06-06 16:37:08.998581 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:09.000204 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-06-06 16:37:09.000204 (Thread-1): Using vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:37:09.000742 (Thread-1): On model.vertica_test_project.stg_cwurdata: COMMIT
2021-06-06 16:37:09.004161 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:37:09.008536 (Thread-1): finished collecting timing info
2021-06-06 16:37:09.009075 (Thread-1): On model.vertica_test_project.stg_cwurdata: Close
2021-06-06 16:37:09.010749 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63489567-9f98-4285-a07c-8d53b3fd944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF609A2760>]}
2021-06-06 16:37:09.013598 (Thread-1): 20:37:09 | 3 of 4 OK created view model dbt_schema.stg_cwurdata................. [-1 in 0.08s]
2021-06-06 16:37:09.014651 (Thread-1): Finished running node model.vertica_test_project.stg_cwurdata
2021-06-06 16:37:09.015662 (Thread-1): Began running node model.vertica_test_project.stg_school_and_country
2021-06-06 16:37:09.018192 (Thread-1): 20:37:09 | 4 of 4 START view model dbt_schema.stg_school_and_country............ [RUN]
2021-06-06 16:37:09.019282 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:37:09.019826 (Thread-1): Compiling model.vertica_test_project.stg_school_and_country
2021-06-06 16:37:09.037041 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_school_and_country"
2021-06-06 16:37:09.038055 (Thread-1): finished collecting timing info
2021-06-06 16:37:09.048042 (Thread-1): Writing runtime SQL for node "model.vertica_test_project.stg_school_and_country"
2021-06-06 16:37:09.050048 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:37:09.050048 (Thread-1): On model.vertica_test_project.stg_school_and_country: BEGIN
2021-06-06 16:37:09.050048 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:37:09.062099 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:37:09.066664 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:37:09.067215 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:37:09.067215 (Thread-1): On model.vertica_test_project.stg_school_and_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "model.vertica_test_project.stg_school_and_country"} */

  

  
  create or replace view "docker"."dbt_schema"."stg_school_and_country" as (
    select
	school_name,
	country 
from "docker"."dbt_schema"."school_and_country_table"
  );


2021-06-06 16:37:09.078849 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:09.080492 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-06-06 16:37:09.081031 (Thread-1): Using vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:37:09.081031 (Thread-1): On model.vertica_test_project.stg_school_and_country: COMMIT
2021-06-06 16:37:09.084896 (Thread-1): SQL status: -1 in 0.00 seconds
2021-06-06 16:37:09.088171 (Thread-1): finished collecting timing info
2021-06-06 16:37:09.088725 (Thread-1): On model.vertica_test_project.stg_school_and_country: Close
2021-06-06 16:37:09.090467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63489567-9f98-4285-a07c-8d53b3fd944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60741BE0>]}
2021-06-06 16:37:09.093961 (Thread-1): 20:37:09 | 4 of 4 OK created view model dbt_schema.stg_school_and_country....... [-1 in 0.07s]
2021-06-06 16:37:09.095063 (Thread-1): Finished running node model.vertica_test_project.stg_school_and_country
2021-06-06 16:37:09.097384 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:37:09.097891 (MainThread): Using vertica connection "master".
2021-06-06 16:37:09.097935 (MainThread): On master: BEGIN
2021-06-06 16:37:09.097935 (MainThread): Opening a new connection, currently in state closed
2021-06-06 16:37:09.107839 (MainThread): :P Connected to database: docker at localhost
2021-06-06 16:37:09.114329 (MainThread): SQL status: -1 in 0.02 seconds
2021-06-06 16:37:09.114973 (MainThread): On master: COMMIT
2021-06-06 16:37:09.114973 (MainThread): Using vertica connection "master".
2021-06-06 16:37:09.114973 (MainThread): On master: COMMIT
2021-06-06 16:37:09.120859 (MainThread): SQL status: -1 in 0.01 seconds
2021-06-06 16:37:09.121454 (MainThread): On master: Close
2021-06-06 16:37:09.122554 (MainThread): 20:37:09 | 
2021-06-06 16:37:09.123107 (MainThread): 20:37:09 | Finished running 4 view models in 0.67s.
2021-06-06 16:37:09.126109 (MainThread): Connection 'master' was properly closed.
2021-06-06 16:37:09.126695 (MainThread): Connection 'list_docker' was properly closed.
2021-06-06 16:37:09.126695 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 16:37:09.127224 (MainThread): Connection 'model.vertica_test_project.stg_school_and_country' was properly closed.
2021-06-06 16:37:09.156116 (MainThread): 
2021-06-06 16:37:09.157115 (MainThread): Completed successfully
2021-06-06 16:37:09.159126 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-06 16:37:09.167389 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60741BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60985A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60985C10>]}
2021-06-06 16:37:09.168402 (MainThread): Flushing usage events
2021-06-06 16:51:33.010205 (MainThread): Running with dbt=0.18.2
2021-06-06 16:51:33.204266 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-06 16:51:33.206267 (MainThread): Tracking: tracking
2021-06-06 16:51:33.207267 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E42600F640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4260D5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4260D51F0>]}
2021-06-06 16:51:33.243275 (MainThread): Partial parsing not enabled
2021-06-06 16:51:33.246272 (MainThread): Parsing macros\adapters.sql
2021-06-06 16:51:33.289270 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 16:51:33.300267 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 16:51:33.326270 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 16:51:33.340278 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 16:51:33.349271 (MainThread): Parsing macros\core.sql
2021-06-06 16:51:33.358273 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 16:51:33.451273 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 16:51:33.472276 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 16:51:33.476274 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 16:51:33.481287 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 16:51:33.486275 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 16:51:33.491274 (MainThread): Parsing macros\etc\query.sql
2021-06-06 16:51:33.495274 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 16:51:33.511272 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 16:51:33.536714 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 16:51:33.541717 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 16:51:33.552716 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 16:51:33.586717 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 16:51:33.637718 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 16:51:33.641717 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 16:51:33.668722 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 16:51:33.684002 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 16:51:33.692452 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 16:51:33.703451 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 16:51:33.709454 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 16:51:33.712454 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 16:51:33.716451 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 16:51:33.728454 (MainThread): Partial parsing not enabled
2021-06-06 16:51:33.782457 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:51:33.816455 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:51:33.834455 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:51:33.849457 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:51:34.280296 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.test_model
- models.marts
- models.staging
- seeds.test_model

2021-06-06 16:51:34.404303 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 16:51:34.406299 (MainThread): 
2021-06-06 16:51:34.407325 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:51:34.443404 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 16:51:34.462405 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:51:34.462405 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 16:51:34.462405 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 16:51:34.488493 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 16:51:34.492543 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 16:51:34.493064 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:51:34.493064 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 16:51:34.514603 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.529982 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 16:51:34.534342 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 16:51:34.536555 (MainThread): 20:51:34 | Concurrency: 1 threads (target='dev')
2021-06-06 16:51:34.537438 (MainThread): 20:51:34 | 
2021-06-06 16:51:34.549022 (Thread-1): Began running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:51:34.549022 (Thread-1): 20:51:34 | 1 of 8 START test not_null_cwurData_country.......................... [RUN]
2021-06-06 16:51:34.550023 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:51:34.550023 (Thread-1): Compiling test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:51:34.584023 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_cwurData_country"
2021-06-06 16:51:34.589024 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.590022 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:51:34.590022 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: BEGIN
2021-06-06 16:51:34.590022 (Thread-1): Opening a new connection, currently in state init
2021-06-06 16:51:34.601022 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:34.605023 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.605023 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:51:34.605023 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_cwurData_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."cwurData"
where country is null



2021-06-06 16:51:34.624654 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.625746 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.626273 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: ROLLBACK
2021-06-06 16:51:34.630181 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: Close
2021-06-06 16:51:34.631289 (Thread-1): 20:51:34 | 1 of 8 PASS not_null_cwurData_country................................ [PASS in 0.08s]
2021-06-06 16:51:34.633119 (Thread-1): Finished running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:51:34.633674 (Thread-1): Began running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:51:34.634257 (Thread-1): 20:51:34 | 2 of 8 START test not_null_school_and_country_table_country.......... [RUN]
2021-06-06 16:51:34.634800 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:51:34.635306 (Thread-1): Compiling test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:51:34.648620 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_school_and_country_table_country"
2021-06-06 16:51:34.652615 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.652615 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:51:34.652615 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: BEGIN
2021-06-06 16:51:34.652615 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:51:34.666335 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:34.670724 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.670765 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:51:34.671314 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."school_and_country_table"
where country is null



2021-06-06 16:51:34.684199 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:51:34.684743 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.685304 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: ROLLBACK
2021-06-06 16:51:34.689805 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: Close
2021-06-06 16:51:34.690933 (Thread-1): 20:51:34 | 2 of 8 PASS not_null_school_and_country_table_country................ [PASS in 0.06s]
2021-06-06 16:51:34.692844 (Thread-1): Finished running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:51:34.693393 (Thread-1): Began running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:51:34.693959 (Thread-1): 20:51:34 | 3 of 8 START test not_null_stg_cwurdata_institution.................. [RUN]
2021-06-06 16:51:34.695065 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:51:34.695612 (Thread-1): Compiling test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:51:34.720665 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_cwurdata_institution"
2021-06-06 16:51:34.724666 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.724666 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:51:34.724666 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: BEGIN
2021-06-06 16:51:34.724666 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:51:34.737137 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:34.741233 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.741787 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:51:34.741787 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_cwurdata"
where institution is null



2021-06-06 16:51:34.756499 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:51:34.757006 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.757608 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:51:34.762620 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: Close
2021-06-06 16:51:34.763768 (Thread-1): 20:51:34 | 3 of 8 PASS not_null_stg_cwurdata_institution........................ [PASS in 0.07s]
2021-06-06 16:51:34.765570 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:51:34.766174 (Thread-1): Began running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:51:34.766727 (Thread-1): 20:51:34 | 4 of 8 START test not_null_stg_school_and_country_country............ [RUN]
2021-06-06 16:51:34.767297 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:51:34.767860 (Thread-1): Compiling test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:51:34.789848 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_school_and_country_country"
2021-06-06 16:51:34.791860 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.792853 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:51:34.792853 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: BEGIN
2021-06-06 16:51:34.792853 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:51:34.806985 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:34.811487 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.812035 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:51:34.812035 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_school_and_country"
where country is null



2021-06-06 16:51:34.824006 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:51:34.824531 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.825076 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: ROLLBACK
2021-06-06 16:51:34.828888 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: Close
2021-06-06 16:51:34.829983 (Thread-1): 20:51:34 | 4 of 8 PASS not_null_stg_school_and_country_country.................. [PASS in 0.06s]
2021-06-06 16:51:34.831791 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:51:34.832346 (Thread-1): Began running node test.vertica_test_project.unique_cwurData_country
2021-06-06 16:51:34.832922 (Thread-1): 20:51:34 | 5 of 8 START test unique_cwurData_country............................ [RUN]
2021-06-06 16:51:34.834045 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_cwurData_country".
2021-06-06 16:51:34.834045 (Thread-1): Compiling test.vertica_test_project.unique_cwurData_country
2021-06-06 16:51:34.854567 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_cwurData_country"
2021-06-06 16:51:34.856567 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.857568 (Thread-1): Using vertica connection "test.vertica_test_project.unique_cwurData_country".
2021-06-06 16:51:34.857568 (Thread-1): On test.vertica_test_project.unique_cwurData_country: BEGIN
2021-06-06 16:51:34.857568 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:51:34.869893 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:34.874391 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.874953 (Thread-1): Using vertica connection "test.vertica_test_project.unique_cwurData_country".
2021-06-06 16:51:34.874953 (Thread-1): On test.vertica_test_project.unique_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_cwurData_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."cwurData"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:51:34.905954 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:51:34.906473 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.906513 (Thread-1): On test.vertica_test_project.unique_cwurData_country: ROLLBACK
2021-06-06 16:51:34.910899 (Thread-1): On test.vertica_test_project.unique_cwurData_country: Close
2021-06-06 16:51:34.912669 (Thread-1): 20:51:34 | 5 of 8 FAIL 59 unique_cwurData_country............................... [FAIL 59 in 0.08s]
2021-06-06 16:51:34.914314 (Thread-1): Finished running node test.vertica_test_project.unique_cwurData_country
2021-06-06 16:51:34.914861 (Thread-1): Began running node test.vertica_test_project.unique_school_and_country_table_country
2021-06-06 16:51:34.915433 (Thread-1): 20:51:34 | 6 of 8 START test unique_school_and_country_table_country............ [RUN]
2021-06-06 16:51:34.916650 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_school_and_country_table_country".
2021-06-06 16:51:34.917196 (Thread-1): Compiling test.vertica_test_project.unique_school_and_country_table_country
2021-06-06 16:51:34.940027 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_school_and_country_table_country"
2021-06-06 16:51:34.942028 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.943032 (Thread-1): Using vertica connection "test.vertica_test_project.unique_school_and_country_table_country".
2021-06-06 16:51:34.943032 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: BEGIN
2021-06-06 16:51:34.943032 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:51:34.954769 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:34.958695 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.959240 (Thread-1): Using vertica connection "test.vertica_test_project.unique_school_and_country_table_country".
2021-06-06 16:51:34.959240 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."school_and_country_table"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:51:34.980568 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:34.981113 (Thread-1): finished collecting timing info
2021-06-06 16:51:34.981661 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: ROLLBACK
2021-06-06 16:51:34.985574 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: Close
2021-06-06 16:51:34.986687 (Thread-1): 20:51:34 | 6 of 8 FAIL 51 unique_school_and_country_table_country............... [FAIL 51 in 0.07s]
2021-06-06 16:51:34.988462 (Thread-1): Finished running node test.vertica_test_project.unique_school_and_country_table_country
2021-06-06 16:51:34.989536 (Thread-1): Began running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:51:34.990141 (Thread-1): 20:51:34 | 7 of 8 START test unique_stg_cwurdata_institution.................... [RUN]
2021-06-06 16:51:34.990690 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:51:34.991277 (Thread-1): Compiling test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:51:35.008399 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_cwurdata_institution"
2021-06-06 16:51:35.010401 (Thread-1): finished collecting timing info
2021-06-06 16:51:35.010401 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:51:35.010401 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: BEGIN
2021-06-06 16:51:35.010401 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:51:35.023743 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:35.028179 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:35.028179 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:51:35.028179 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from (

    select
        institution

    from "docker"."dbt_schema"."stg_cwurdata"
    where institution is not null
    group by institution
    having count(*) > 1

) validation_errors



2021-06-06 16:51:35.056635 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:51:35.057195 (Thread-1): finished collecting timing info
2021-06-06 16:51:35.057731 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:51:35.061532 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: Close
2021-06-06 16:51:35.062627 (Thread-1): 20:51:35 | 7 of 8 FAIL 1024 unique_stg_cwurdata_institution..................... [FAIL 1024 in 0.07s]
2021-06-06 16:51:35.064343 (Thread-1): Finished running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:51:35.064979 (Thread-1): Began running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:51:35.065525 (Thread-1): 20:51:35 | 8 of 8 START test unique_stg_school_and_country_country.............. [RUN]
2021-06-06 16:51:35.066634 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:51:35.066634 (Thread-1): Compiling test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:51:35.082480 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_school_and_country_country"
2021-06-06 16:51:35.085474 (Thread-1): finished collecting timing info
2021-06-06 16:51:35.086474 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:51:35.086474 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: BEGIN
2021-06-06 16:51:35.086474 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:51:35.098462 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:51:35.103534 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:35.103534 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:51:35.104127 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."stg_school_and_country"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:51:35.128618 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:51:35.129184 (Thread-1): finished collecting timing info
2021-06-06 16:51:35.129760 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: ROLLBACK
2021-06-06 16:51:35.134884 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: Close
2021-06-06 16:51:35.136090 (Thread-1): 20:51:35 | 8 of 8 FAIL 51 unique_stg_school_and_country_country................. [FAIL 51 in 0.07s]
2021-06-06 16:51:35.137196 (Thread-1): Finished running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:51:35.139717 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:51:35.140717 (MainThread): 20:51:35 | 
2021-06-06 16:51:35.140717 (MainThread): 20:51:35 | Finished running 8 tests in 0.73s.
2021-06-06 16:51:35.141722 (MainThread): Connection 'master' was properly closed.
2021-06-06 16:51:35.141722 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 16:51:35.141722 (MainThread): Connection 'test.vertica_test_project.unique_stg_school_and_country_country' was properly closed.
2021-06-06 16:51:35.189696 (MainThread): 
2021-06-06 16:51:35.190206 (MainThread): Completed with 4 errors and 0 warnings:
2021-06-06 16:51:35.193069 (MainThread): 
2021-06-06 16:51:35.199598 (MainThread): Failure in test unique_cwurData_country (data\seeds\schema.yml)
2021-06-06 16:51:35.203593 (MainThread):   Got 59 results, expected 0.
2021-06-06 16:51:35.204591 (MainThread): 
2021-06-06 16:51:35.210590 (MainThread):   compiled SQL at target\compiled\vertica_test_project\data\seeds\schema.yml\schema_test\unique_cwurData_country.sql
2021-06-06 16:51:35.216595 (MainThread): 
2021-06-06 16:51:35.216595 (MainThread): Failure in test unique_school_and_country_table_country (data\seeds\schema.yml)
2021-06-06 16:51:35.223592 (MainThread):   Got 51 results, expected 0.
2021-06-06 16:51:35.223592 (MainThread): 
2021-06-06 16:51:35.228594 (MainThread):   compiled SQL at target\compiled\vertica_test_project\data\seeds\schema.yml\schema_test\unique_school_and_country_table_country.sql
2021-06-06 16:51:35.236615 (MainThread): 
2021-06-06 16:51:35.239596 (MainThread): Failure in test unique_stg_cwurdata_institution (models\staging\schema.yml)
2021-06-06 16:51:35.240592 (MainThread):   Got 1024 results, expected 0.
2021-06-06 16:51:35.249595 (MainThread): 
2021-06-06 16:51:35.271592 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_cwurdata_institution.sql
2021-06-06 16:51:35.272593 (MainThread): 
2021-06-06 16:51:35.273595 (MainThread): Failure in test unique_stg_school_and_country_country (models\staging\schema.yml)
2021-06-06 16:51:35.290592 (MainThread):   Got 51 results, expected 0.
2021-06-06 16:51:35.291595 (MainThread): 
2021-06-06 16:51:35.292600 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_school_and_country_country.sql
2021-06-06 16:51:35.294597 (MainThread): 
Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
2021-06-06 16:51:35.295595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E42637A5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E42637A730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E42637A580>]}
2021-06-06 16:51:35.295595 (MainThread): Flushing usage events
2021-06-06 16:52:20.622315 (MainThread): Running with dbt=0.18.2
2021-06-06 16:52:20.803008 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-06 16:52:20.805008 (MainThread): Tracking: tracking
2021-06-06 16:52:20.806008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025979D106D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025979DD93D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025979DD9280>]}
2021-06-06 16:52:20.839011 (MainThread): Partial parsing not enabled
2021-06-06 16:52:20.841015 (MainThread): Parsing macros\adapters.sql
2021-06-06 16:52:20.880491 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 16:52:20.890762 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 16:52:20.917763 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 16:52:20.927760 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 16:52:20.933763 (MainThread): Parsing macros\core.sql
2021-06-06 16:52:20.940765 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 16:52:21.006764 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 16:52:21.022766 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 16:52:21.024767 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 16:52:21.027765 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 16:52:21.031764 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 16:52:21.034765 (MainThread): Parsing macros\etc\query.sql
2021-06-06 16:52:21.037765 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 16:52:21.052765 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 16:52:21.074764 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 16:52:21.078765 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 16:52:21.089767 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 16:52:21.127767 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 16:52:21.181768 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 16:52:21.185767 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 16:52:21.214767 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 16:52:21.230724 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 16:52:21.239135 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 16:52:21.251135 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 16:52:21.256135 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 16:52:21.259136 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 16:52:21.262134 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 16:52:21.274138 (MainThread): Partial parsing not enabled
2021-06-06 16:52:21.346136 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:52:21.388546 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:52:21.406547 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:52:21.423546 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:52:21.822240 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.staging
- models.marts
- models.test_model
- seeds.test_model

2021-06-06 16:52:21.943552 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 16:52:21.946554 (MainThread): 
2021-06-06 16:52:21.947554 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:52:21.983556 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 16:52:22.005561 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:52:22.005561 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 16:52:22.005561 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 16:52:22.031057 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 16:52:22.035511 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 16:52:22.036061 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:52:22.036061 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 16:52:22.055302 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.068826 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 16:52:22.072776 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 16:52:22.075675 (MainThread): 20:52:22 | Concurrency: 1 threads (target='dev')
2021-06-06 16:52:22.076218 (MainThread): 20:52:22 | 
2021-06-06 16:52:22.089888 (Thread-1): Began running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:52:22.089888 (Thread-1): 20:52:22 | 1 of 7 START test not_null_cwurData_country.......................... [RUN]
2021-06-06 16:52:22.090873 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:52:22.090873 (Thread-1): Compiling test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:52:22.120872 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_cwurData_country"
2021-06-06 16:52:22.123915 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.123915 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:52:22.123915 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: BEGIN
2021-06-06 16:52:22.123915 (Thread-1): Opening a new connection, currently in state init
2021-06-06 16:52:22.136384 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:52:22.140940 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.141483 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:52:22.141483 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_cwurData_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."cwurData"
where country is null



2021-06-06 16:52:22.153846 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:52:22.154411 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.154939 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: ROLLBACK
2021-06-06 16:52:22.158827 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: Close
2021-06-06 16:52:22.159991 (Thread-1): 20:52:22 | 1 of 7 PASS not_null_cwurData_country................................ [PASS in 0.07s]
2021-06-06 16:52:22.161287 (Thread-1): Finished running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:52:22.161915 (Thread-1): Began running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:52:22.162468 (Thread-1): 20:52:22 | 2 of 7 START test not_null_school_and_country_table_country.......... [RUN]
2021-06-06 16:52:22.163610 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:52:22.163610 (Thread-1): Compiling test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:52:22.182517 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_school_and_country_table_country"
2021-06-06 16:52:22.184514 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.184514 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:52:22.184514 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: BEGIN
2021-06-06 16:52:22.184514 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:52:22.196478 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:52:22.200354 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.200354 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:52:22.200888 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."school_and_country_table"
where country is null



2021-06-06 16:52:22.211892 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:52:22.212444 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.212981 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: ROLLBACK
2021-06-06 16:52:22.216777 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: Close
2021-06-06 16:52:22.217865 (Thread-1): 20:52:22 | 2 of 7 PASS not_null_school_and_country_table_country................ [PASS in 0.05s]
2021-06-06 16:52:22.218960 (Thread-1): Finished running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:52:22.219720 (Thread-1): Began running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:52:22.220273 (Thread-1): 20:52:22 | 3 of 7 START test not_null_stg_cwurdata_institution.................. [RUN]
2021-06-06 16:52:22.221410 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:52:22.221410 (Thread-1): Compiling test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:52:22.240815 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_cwurdata_institution"
2021-06-06 16:52:22.243814 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.244813 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:52:22.244813 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: BEGIN
2021-06-06 16:52:22.244813 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:52:22.256631 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:52:22.261201 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.261201 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:52:22.261201 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_cwurdata"
where institution is null



2021-06-06 16:52:22.275291 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:52:22.275860 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.276404 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:52:22.280263 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: Close
2021-06-06 16:52:22.281551 (Thread-1): 20:52:22 | 3 of 7 PASS not_null_stg_cwurdata_institution........................ [PASS in 0.06s]
2021-06-06 16:52:22.283225 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:52:22.283674 (Thread-1): Began running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:52:22.284218 (Thread-1): 20:52:22 | 4 of 7 START test not_null_stg_school_and_country_country............ [RUN]
2021-06-06 16:52:22.285315 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:52:22.285315 (Thread-1): Compiling test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:52:22.303360 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_school_and_country_country"
2021-06-06 16:52:22.307367 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.308353 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:52:22.308353 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: BEGIN
2021-06-06 16:52:22.308353 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:52:22.320204 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:52:22.325412 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.325412 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:52:22.325958 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_school_and_country"
where country is null



2021-06-06 16:52:22.338300 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:52:22.339303 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.339303 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: ROLLBACK
2021-06-06 16:52:22.343300 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: Close
2021-06-06 16:52:22.345310 (Thread-1): 20:52:22 | 4 of 7 PASS not_null_stg_school_and_country_country.................. [PASS in 0.06s]
2021-06-06 16:52:22.347304 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:52:22.347304 (Thread-1): Began running node test.vertica_test_project.unique_cwurData_country
2021-06-06 16:52:22.347304 (Thread-1): 20:52:22 | 5 of 7 START test unique_cwurData_country............................ [RUN]
2021-06-06 16:52:22.348298 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_cwurData_country".
2021-06-06 16:52:22.348298 (Thread-1): Compiling test.vertica_test_project.unique_cwurData_country
2021-06-06 16:52:22.365301 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_cwurData_country"
2021-06-06 16:52:22.367312 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.368302 (Thread-1): Using vertica connection "test.vertica_test_project.unique_cwurData_country".
2021-06-06 16:52:22.368302 (Thread-1): On test.vertica_test_project.unique_cwurData_country: BEGIN
2021-06-06 16:52:22.368302 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:52:22.382865 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:52:22.386811 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.387397 (Thread-1): Using vertica connection "test.vertica_test_project.unique_cwurData_country".
2021-06-06 16:52:22.387397 (Thread-1): On test.vertica_test_project.unique_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_cwurData_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."cwurData"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:52:22.413286 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:52:22.413837 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.414377 (Thread-1): On test.vertica_test_project.unique_cwurData_country: ROLLBACK
2021-06-06 16:52:22.418232 (Thread-1): On test.vertica_test_project.unique_cwurData_country: Close
2021-06-06 16:52:22.419325 (Thread-1): 20:52:22 | 5 of 7 FAIL 59 unique_cwurData_country............................... [FAIL 59 in 0.07s]
2021-06-06 16:52:22.420969 (Thread-1): Finished running node test.vertica_test_project.unique_cwurData_country
2021-06-06 16:52:22.421559 (Thread-1): Began running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:52:22.422114 (Thread-1): 20:52:22 | 6 of 7 START test unique_stg_cwurdata_institution.................... [RUN]
2021-06-06 16:52:22.423214 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:52:22.423214 (Thread-1): Compiling test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:52:22.438128 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_cwurdata_institution"
2021-06-06 16:52:22.440129 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.441130 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:52:22.441130 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: BEGIN
2021-06-06 16:52:22.442133 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:52:22.455530 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:52:22.460767 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.460767 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:52:22.461342 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from (

    select
        institution

    from "docker"."dbt_schema"."stg_cwurdata"
    where institution is not null
    group by institution
    having count(*) > 1

) validation_errors



2021-06-06 16:52:22.496770 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:52:22.497277 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.497305 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:52:22.501162 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: Close
2021-06-06 16:52:22.502363 (Thread-1): 20:52:22 | 6 of 7 FAIL 1024 unique_stg_cwurdata_institution..................... [FAIL 1024 in 0.08s]
2021-06-06 16:52:22.503962 (Thread-1): Finished running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:52:22.504766 (Thread-1): Began running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:52:22.505397 (Thread-1): 20:52:22 | 7 of 7 START test unique_stg_school_and_country_country.............. [RUN]
2021-06-06 16:52:22.505993 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:52:22.506541 (Thread-1): Compiling test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:52:22.520369 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_school_and_country_country"
2021-06-06 16:52:22.523368 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.523368 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:52:22.524393 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: BEGIN
2021-06-06 16:52:22.524393 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:52:22.536266 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:52:22.542059 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:52:22.542059 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:52:22.542567 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."stg_school_and_country"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:52:22.577268 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:52:22.577825 (Thread-1): finished collecting timing info
2021-06-06 16:52:22.578379 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: ROLLBACK
2021-06-06 16:52:22.582267 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: Close
2021-06-06 16:52:22.583473 (Thread-1): 20:52:22 | 7 of 7 FAIL 51 unique_stg_school_and_country_country................. [FAIL 51 in 0.08s]
2021-06-06 16:52:22.584890 (Thread-1): Finished running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:52:22.587815 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:52:22.588372 (MainThread): 20:52:22 | 
2021-06-06 16:52:22.588931 (MainThread): 20:52:22 | Finished running 7 tests in 0.64s.
2021-06-06 16:52:22.589480 (MainThread): Connection 'master' was properly closed.
2021-06-06 16:52:22.590031 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 16:52:22.590031 (MainThread): Connection 'test.vertica_test_project.unique_stg_school_and_country_country' was properly closed.
2021-06-06 16:52:22.622743 (MainThread): 
2021-06-06 16:52:22.623698 (MainThread): Completed with 3 errors and 0 warnings:
2021-06-06 16:52:22.625694 (MainThread): 
2021-06-06 16:52:22.632714 (MainThread): Failure in test unique_cwurData_country (data\seeds\schema.yml)
2021-06-06 16:52:22.637710 (MainThread):   Got 59 results, expected 0.
2021-06-06 16:52:22.644701 (MainThread): 
2021-06-06 16:52:22.644701 (MainThread):   compiled SQL at target\compiled\vertica_test_project\data\seeds\schema.yml\schema_test\unique_cwurData_country.sql
2021-06-06 16:52:22.647705 (MainThread): 
2021-06-06 16:52:22.648695 (MainThread): Failure in test unique_stg_cwurdata_institution (models\staging\schema.yml)
2021-06-06 16:52:22.658696 (MainThread):   Got 1024 results, expected 0.
2021-06-06 16:52:22.659696 (MainThread): 
2021-06-06 16:52:22.666699 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_cwurdata_institution.sql
2021-06-06 16:52:22.666699 (MainThread): 
2021-06-06 16:52:22.671711 (MainThread): Failure in test unique_stg_school_and_country_country (models\staging\schema.yml)
2021-06-06 16:52:22.677703 (MainThread):   Got 51 results, expected 0.
2021-06-06 16:52:22.679694 (MainThread): 
2021-06-06 16:52:22.682700 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_school_and_country_country.sql
2021-06-06 16:52:22.683697 (MainThread): 
Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
2021-06-06 16:52:22.692699 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025979E3F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002597A08C1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002597A08CBE0>]}
2021-06-06 16:52:22.692699 (MainThread): Flushing usage events
2021-06-06 16:53:21.603195 (MainThread): Running with dbt=0.18.2
2021-06-06 16:53:21.796165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-06 16:53:21.797166 (MainThread): Tracking: tracking
2021-06-06 16:53:21.798165 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4126E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA41336400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA41336190>]}
2021-06-06 16:53:21.839173 (MainThread): Partial parsing not enabled
2021-06-06 16:53:21.841167 (MainThread): Parsing macros\adapters.sql
2021-06-06 16:53:21.884167 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 16:53:21.894167 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 16:53:21.918167 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 16:53:21.929167 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 16:53:21.934168 (MainThread): Parsing macros\core.sql
2021-06-06 16:53:21.940168 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 16:53:22.015171 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 16:53:22.036170 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 16:53:22.038171 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 16:53:22.041170 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 16:53:22.045172 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 16:53:22.048172 (MainThread): Parsing macros\etc\query.sql
2021-06-06 16:53:22.051176 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 16:53:22.065172 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 16:53:22.088177 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 16:53:22.091177 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 16:53:22.102179 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 16:53:22.138446 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 16:53:22.189407 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 16:53:22.193409 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 16:53:22.223409 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 16:53:22.236409 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 16:53:22.247411 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 16:53:22.262414 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 16:53:22.269412 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 16:53:22.273410 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 16:53:22.276410 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 16:53:22.292411 (MainThread): Partial parsing not enabled
2021-06-06 16:53:22.359413 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:53:22.401415 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:53:22.420415 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:53:22.441413 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:53:22.841131 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.marts
- models.staging
- models.test_model
- seeds.test_model

2021-06-06 16:53:22.941128 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 16:53:22.943128 (MainThread): 
2021-06-06 16:53:22.944128 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:53:22.974131 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 16:53:22.989132 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:53:22.989132 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 16:53:22.989132 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 16:53:23.013488 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 16:53:23.017949 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 16:53:23.017949 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:53:23.017949 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 16:53:23.036626 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.049161 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 16:53:23.053354 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 16:53:23.055668 (MainThread): 20:53:23 | Concurrency: 1 threads (target='dev')
2021-06-06 16:53:23.056973 (MainThread): 20:53:23 | 
2021-06-06 16:53:23.065302 (Thread-1): Began running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:53:23.065845 (Thread-1): 20:53:23 | 1 of 7 START test not_null_cwurData_country.......................... [RUN]
2021-06-06 16:53:23.066406 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:53:23.066956 (Thread-1): Compiling test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:53:23.093564 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_cwurData_country"
2021-06-06 16:53:23.095562 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.095562 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:53:23.095562 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: BEGIN
2021-06-06 16:53:23.096563 (Thread-1): Opening a new connection, currently in state init
2021-06-06 16:53:23.106968 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:53:23.110830 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:53:23.110830 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:53:23.110830 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_cwurData_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."cwurData"
where country is null



2021-06-06 16:53:23.124164 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:53:23.124769 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.125300 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: ROLLBACK
2021-06-06 16:53:23.128666 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: Close
2021-06-06 16:53:23.130301 (Thread-1): 20:53:23 | 1 of 7 PASS not_null_cwurData_country................................ [PASS in 0.06s]
2021-06-06 16:53:23.132017 (Thread-1): Finished running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:53:23.132840 (Thread-1): Began running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:53:23.133427 (Thread-1): 20:53:23 | 2 of 7 START test not_null_school_and_country_table_country.......... [RUN]
2021-06-06 16:53:23.134574 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:53:23.134574 (Thread-1): Compiling test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:53:23.155434 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_school_and_country_table_country"
2021-06-06 16:53:23.157431 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.158430 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:53:23.158430 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: BEGIN
2021-06-06 16:53:23.158430 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:53:23.169731 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:53:23.173654 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.174203 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:53:23.174203 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."school_and_country_table"
where country is null



2021-06-06 16:53:23.186315 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:53:23.186866 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.187404 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: ROLLBACK
2021-06-06 16:53:23.191164 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: Close
2021-06-06 16:53:23.192311 (Thread-1): 20:53:23 | 2 of 7 PASS not_null_school_and_country_table_country................ [PASS in 0.06s]
2021-06-06 16:53:23.193489 (Thread-1): Finished running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:53:23.194622 (Thread-1): Began running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:53:23.195231 (Thread-1): 20:53:23 | 3 of 7 START test not_null_stg_cwurdata_institution.................. [RUN]
2021-06-06 16:53:23.196360 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:53:23.196901 (Thread-1): Compiling test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:53:23.212276 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_cwurdata_institution"
2021-06-06 16:53:23.216271 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.216271 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:53:23.216271 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: BEGIN
2021-06-06 16:53:23.216271 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:53:23.228524 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:53:23.233063 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.233063 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:53:23.233063 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_cwurdata"
where institution is null



2021-06-06 16:53:23.245667 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:53:23.246225 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.246752 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:53:23.250587 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: Close
2021-06-06 16:53:23.251679 (Thread-1): 20:53:23 | 3 of 7 PASS not_null_stg_cwurdata_institution........................ [PASS in 0.06s]
2021-06-06 16:53:23.253355 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:53:23.253960 (Thread-1): Began running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:53:23.254538 (Thread-1): 20:53:23 | 4 of 7 START test not_null_stg_school_and_country_country............ [RUN]
2021-06-06 16:53:23.255658 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:53:23.255658 (Thread-1): Compiling test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:53:23.273286 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_school_and_country_country"
2021-06-06 16:53:23.275879 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.277008 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:53:23.277529 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: BEGIN
2021-06-06 16:53:23.277529 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:53:23.290527 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:53:23.297748 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.298314 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:53:23.298314 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_school_and_country"
where country is null



2021-06-06 16:53:23.309618 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:53:23.310161 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.310161 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: ROLLBACK
2021-06-06 16:53:23.314536 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: Close
2021-06-06 16:53:23.315631 (Thread-1): 20:53:23 | 4 of 7 PASS not_null_stg_school_and_country_country.................. [PASS in 0.06s]
2021-06-06 16:53:23.316622 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:53:23.317622 (Thread-1): Began running node test.vertica_test_project.unique_school_and_country_table_country
2021-06-06 16:53:23.318618 (Thread-1): 20:53:23 | 5 of 7 START test unique_school_and_country_table_country............ [RUN]
2021-06-06 16:53:23.319618 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_school_and_country_table_country".
2021-06-06 16:53:23.319618 (Thread-1): Compiling test.vertica_test_project.unique_school_and_country_table_country
2021-06-06 16:53:23.338289 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_school_and_country_table_country"
2021-06-06 16:53:23.339869 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.340880 (Thread-1): Using vertica connection "test.vertica_test_project.unique_school_and_country_table_country".
2021-06-06 16:53:23.340880 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: BEGIN
2021-06-06 16:53:23.340880 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:53:23.355502 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:53:23.360029 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.360573 (Thread-1): Using vertica connection "test.vertica_test_project.unique_school_and_country_table_country".
2021-06-06 16:53:23.360573 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."school_and_country_table"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:53:23.389011 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:53:23.389516 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.389561 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: ROLLBACK
2021-06-06 16:53:23.393971 (Thread-1): On test.vertica_test_project.unique_school_and_country_table_country: Close
2021-06-06 16:53:23.395076 (Thread-1): 20:53:23 | 5 of 7 FAIL 51 unique_school_and_country_table_country............... [FAIL 51 in 0.08s]
2021-06-06 16:53:23.396172 (Thread-1): Finished running node test.vertica_test_project.unique_school_and_country_table_country
2021-06-06 16:53:23.396854 (Thread-1): Began running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:53:23.398029 (Thread-1): 20:53:23 | 6 of 7 START test unique_stg_cwurdata_institution.................... [RUN]
2021-06-06 16:53:23.398584 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:53:23.399135 (Thread-1): Compiling test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:53:23.415485 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_cwurdata_institution"
2021-06-06 16:53:23.417521 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.418042 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:53:23.418042 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: BEGIN
2021-06-06 16:53:23.418549 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:53:23.429593 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:53:23.434131 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.434671 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:53:23.434671 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from (

    select
        institution

    from "docker"."dbt_schema"."stg_cwurdata"
    where institution is not null
    group by institution
    having count(*) > 1

) validation_errors



2021-06-06 16:53:23.459330 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.459876 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.460429 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:53:23.464473 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: Close
2021-06-06 16:53:23.466083 (Thread-1): 20:53:23 | 6 of 7 FAIL 1024 unique_stg_cwurdata_institution..................... [FAIL 1024 in 0.07s]
2021-06-06 16:53:23.467452 (Thread-1): Finished running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:53:23.468017 (Thread-1): Began running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:53:23.468565 (Thread-1): 20:53:23 | 7 of 7 START test unique_stg_school_and_country_country.............. [RUN]
2021-06-06 16:53:23.469658 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:53:23.470230 (Thread-1): Compiling test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:53:23.490175 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_school_and_country_country"
2021-06-06 16:53:23.491718 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.492735 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:53:23.492735 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: BEGIN
2021-06-06 16:53:23.492735 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:53:23.506777 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:53:23.510756 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.511344 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:53:23.511960 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."stg_school_and_country"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:53:23.534117 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:53:23.534658 (Thread-1): finished collecting timing info
2021-06-06 16:53:23.534658 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: ROLLBACK
2021-06-06 16:53:23.539031 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: Close
2021-06-06 16:53:23.540138 (Thread-1): 20:53:23 | 7 of 7 FAIL 51 unique_stg_school_and_country_country................. [FAIL 51 in 0.07s]
2021-06-06 16:53:23.541400 (Thread-1): Finished running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:53:23.544250 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:53:23.544824 (MainThread): 20:53:23 | 
2021-06-06 16:53:23.545384 (MainThread): 20:53:23 | Finished running 7 tests in 0.60s.
2021-06-06 16:53:23.545932 (MainThread): Connection 'master' was properly closed.
2021-06-06 16:53:23.545932 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 16:53:23.545932 (MainThread): Connection 'test.vertica_test_project.unique_stg_school_and_country_country' was properly closed.
2021-06-06 16:53:23.581617 (MainThread): 
2021-06-06 16:53:23.581617 (MainThread): Completed with 3 errors and 0 warnings:
2021-06-06 16:53:23.584236 (MainThread): 
2021-06-06 16:53:23.590430 (MainThread): Failure in test unique_school_and_country_table_country (data\seeds\schema.yml)
2021-06-06 16:53:23.591998 (MainThread):   Got 51 results, expected 0.
2021-06-06 16:53:23.593011 (MainThread): 
2021-06-06 16:53:23.597388 (MainThread):   compiled SQL at target\compiled\vertica_test_project\data\seeds\schema.yml\schema_test\unique_school_and_country_table_country.sql
2021-06-06 16:53:23.598453 (MainThread): 
2021-06-06 16:53:23.604686 (MainThread): Failure in test unique_stg_cwurdata_institution (models\staging\schema.yml)
2021-06-06 16:53:23.605218 (MainThread):   Got 1024 results, expected 0.
2021-06-06 16:53:23.608799 (MainThread): 
2021-06-06 16:53:23.617507 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_cwurdata_institution.sql
2021-06-06 16:53:23.622032 (MainThread): 
2021-06-06 16:53:23.630029 (MainThread): Failure in test unique_stg_school_and_country_country (models\staging\schema.yml)
2021-06-06 16:53:23.632031 (MainThread):   Got 51 results, expected 0.
2021-06-06 16:53:23.633032 (MainThread): 
2021-06-06 16:53:23.639032 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_school_and_country_country.sql
2021-06-06 16:53:23.640044 (MainThread): 
Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
2021-06-06 16:53:23.642054 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA41256850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4167ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4167AC70>]}
2021-06-06 16:53:23.643058 (MainThread): Flushing usage events
2021-06-06 16:58:16.667179 (MainThread): Running with dbt=0.18.2
2021-06-06 16:58:16.856676 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-06 16:58:16.857680 (MainThread): Tracking: tracking
2021-06-06 16:58:16.858684 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A102F640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A10F94C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A10F91F0>]}
2021-06-06 16:58:16.891681 (MainThread): Partial parsing not enabled
2021-06-06 16:58:16.894677 (MainThread): Parsing macros\adapters.sql
2021-06-06 16:58:16.933679 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 16:58:16.943678 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 16:58:16.969681 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 16:58:16.980684 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 16:58:16.985681 (MainThread): Parsing macros\core.sql
2021-06-06 16:58:16.992715 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 16:58:17.061678 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 16:58:17.076718 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 16:58:17.078712 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 16:58:17.081689 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 16:58:17.085720 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 16:58:17.088714 (MainThread): Parsing macros\etc\query.sql
2021-06-06 16:58:17.090715 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 16:58:17.106678 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 16:58:17.129681 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 16:58:17.135686 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 16:58:17.146683 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 16:58:17.180716 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 16:58:17.227572 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 16:58:17.231574 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 16:58:17.258568 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 16:58:17.268604 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 16:58:17.277573 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 16:58:17.287566 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 16:58:17.292568 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 16:58:17.295566 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 16:58:17.300573 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 16:58:17.311574 (MainThread): Partial parsing not enabled
2021-06-06 16:58:17.365850 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 16:58:17.400848 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 16:58:17.418851 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 16:58:17.433851 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 16:58:17.851135 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.test_model
- models.marts
- models.staging
- seeds.test_model

2021-06-06 16:58:17.956132 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 16:58:17.958173 (MainThread): 
2021-06-06 16:58:17.959134 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:58:17.986136 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 16:58:18.002133 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:58:18.002133 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 16:58:18.002133 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 16:58:18.025509 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 16:58:18.031227 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 16:58:18.031786 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 16:58:18.031786 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 16:58:18.065308 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 16:58:18.079929 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 16:58:18.083514 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 16:58:18.086274 (MainThread): 20:58:18 | Concurrency: 1 threads (target='dev')
2021-06-06 16:58:18.087036 (MainThread): 20:58:18 | 
2021-06-06 16:58:18.097549 (Thread-1): Began running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:58:18.098056 (Thread-1): 20:58:18 | 1 of 6 START test not_null_cwurData_country.......................... [RUN]
2021-06-06 16:58:18.098056 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:58:18.099077 (Thread-1): Compiling test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:58:18.136069 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_cwurData_country"
2021-06-06 16:58:18.138072 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.139068 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:58:18.139068 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: BEGIN
2021-06-06 16:58:18.140077 (Thread-1): Opening a new connection, currently in state init
2021-06-06 16:58:18.160014 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:58:18.163908 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:58:18.163908 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 16:58:18.164466 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_cwurData_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."cwurData"
where country is null



2021-06-06 16:58:18.177465 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:58:18.177971 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.178007 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: ROLLBACK
2021-06-06 16:58:18.182581 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: Close
2021-06-06 16:58:18.183686 (Thread-1): 20:58:18 | 1 of 6 PASS not_null_cwurData_country................................ [PASS in 0.09s]
2021-06-06 16:58:18.185457 (Thread-1): Finished running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 16:58:18.186011 (Thread-1): Began running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:58:18.186572 (Thread-1): 20:58:18 | 2 of 6 START test not_null_school_and_country_table_country.......... [RUN]
2021-06-06 16:58:18.187683 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:58:18.187683 (Thread-1): Compiling test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:58:18.205901 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_school_and_country_table_country"
2021-06-06 16:58:18.207905 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.208902 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:58:18.208902 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: BEGIN
2021-06-06 16:58:18.208902 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:58:18.220764 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:58:18.226003 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:58:18.226561 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 16:58:18.226561 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."school_and_country_table"
where country is null



2021-06-06 16:58:18.237166 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:58:18.237707 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.238263 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: ROLLBACK
2021-06-06 16:58:18.242650 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: Close
2021-06-06 16:58:18.243773 (Thread-1): 20:58:18 | 2 of 6 PASS not_null_school_and_country_table_country................ [PASS in 0.06s]
2021-06-06 16:58:18.245554 (Thread-1): Finished running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 16:58:18.246125 (Thread-1): Began running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:58:18.246690 (Thread-1): 20:58:18 | 3 of 6 START test not_null_stg_cwurdata_institution.................. [RUN]
2021-06-06 16:58:18.247248 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:58:18.247787 (Thread-1): Compiling test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:58:18.266701 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_cwurdata_institution"
2021-06-06 16:58:18.268704 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.269707 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:58:18.269707 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: BEGIN
2021-06-06 16:58:18.270716 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:58:18.281979 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:58:18.285993 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:58:18.285993 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 16:58:18.285993 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_cwurdata"
where institution is null



2021-06-06 16:58:18.299691 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:58:18.300691 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.300691 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:58:18.304688 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: Close
2021-06-06 16:58:18.305690 (Thread-1): 20:58:18 | 3 of 6 PASS not_null_stg_cwurdata_institution........................ [PASS in 0.06s]
2021-06-06 16:58:18.307691 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 16:58:18.307691 (Thread-1): Began running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:58:18.308707 (Thread-1): 20:58:18 | 4 of 6 START test not_null_stg_school_and_country_country............ [RUN]
2021-06-06 16:58:18.309701 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:58:18.309701 (Thread-1): Compiling test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:58:18.324698 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_school_and_country_country"
2021-06-06 16:58:18.330404 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.331527 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:58:18.331527 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: BEGIN
2021-06-06 16:58:18.332137 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:58:18.344091 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:58:18.348665 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:58:18.349211 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 16:58:18.349211 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_school_and_country"
where country is null



2021-06-06 16:58:18.360126 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 16:58:18.360678 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.360678 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: ROLLBACK
2021-06-06 16:58:18.365717 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: Close
2021-06-06 16:58:18.366923 (Thread-1): 20:58:18 | 4 of 6 PASS not_null_stg_school_and_country_country.................. [PASS in 0.06s]
2021-06-06 16:58:18.369130 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 16:58:18.369692 (Thread-1): Began running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:58:18.370224 (Thread-1): 20:58:18 | 5 of 6 START test unique_stg_cwurdata_institution.................... [RUN]
2021-06-06 16:58:18.370788 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:58:18.371333 (Thread-1): Compiling test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:58:18.390336 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_cwurdata_institution"
2021-06-06 16:58:18.393327 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.393327 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:58:18.393327 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: BEGIN
2021-06-06 16:58:18.394326 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:58:18.405311 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:58:18.411238 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:58:18.411798 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 16:58:18.411798 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from (

    select
        institution

    from "docker"."dbt_schema"."stg_cwurdata"
    where institution is not null
    group by institution
    having count(*) > 1

) validation_errors



2021-06-06 16:58:18.449708 (Thread-1): SQL status: -1 in 0.04 seconds
2021-06-06 16:58:18.450251 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.450791 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: ROLLBACK
2021-06-06 16:58:18.455486 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: Close
2021-06-06 16:58:18.457246 (Thread-1): 20:58:18 | 5 of 6 FAIL 1024 unique_stg_cwurdata_institution..................... [FAIL 1024 in 0.09s]
2021-06-06 16:58:18.458957 (Thread-1): Finished running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 16:58:18.459845 (Thread-1): Began running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:58:18.460449 (Thread-1): 20:58:18 | 6 of 6 START test unique_stg_school_and_country_country.............. [RUN]
2021-06-06 16:58:18.460997 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:58:18.461563 (Thread-1): Compiling test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:58:18.476904 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_school_and_country_country"
2021-06-06 16:58:18.479897 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.479897 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:58:18.480898 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: BEGIN
2021-06-06 16:58:18.480898 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 16:58:18.492648 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 16:58:18.496549 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 16:58:18.497107 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 16:58:18.497150 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."stg_school_and_country"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 16:58:18.527755 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 16:58:18.528298 (Thread-1): finished collecting timing info
2021-06-06 16:58:18.528885 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: ROLLBACK
2021-06-06 16:58:18.532676 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: Close
2021-06-06 16:58:18.533776 (Thread-1): 20:58:18 | 6 of 6 FAIL 51 unique_stg_school_and_country_country................. [FAIL 51 in 0.07s]
2021-06-06 16:58:18.534928 (Thread-1): Finished running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 16:58:18.537915 (MainThread): Acquiring new vertica connection "master".
2021-06-06 16:58:18.538464 (MainThread): 20:58:18 | 
2021-06-06 16:58:18.538969 (MainThread): 20:58:18 | Finished running 6 tests in 0.58s.
2021-06-06 16:58:18.539808 (MainThread): Connection 'master' was properly closed.
2021-06-06 16:58:18.540357 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 16:58:18.540357 (MainThread): Connection 'test.vertica_test_project.unique_stg_school_and_country_country' was properly closed.
2021-06-06 16:58:18.571685 (MainThread): 
2021-06-06 16:58:18.572688 (MainThread): Completed with 2 errors and 0 warnings:
2021-06-06 16:58:18.576688 (MainThread): 
2021-06-06 16:58:18.582685 (MainThread): Failure in test unique_stg_cwurdata_institution (models\staging\schema.yml)
2021-06-06 16:58:18.583686 (MainThread):   Got 1024 results, expected 0.
2021-06-06 16:58:18.587685 (MainThread): 
2021-06-06 16:58:18.588687 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_cwurdata_institution.sql
2021-06-06 16:58:18.596684 (MainThread): 
2021-06-06 16:58:18.599685 (MainThread): Failure in test unique_stg_school_and_country_country (models\staging\schema.yml)
2021-06-06 16:58:18.605690 (MainThread):   Got 51 results, expected 0.
2021-06-06 16:58:18.606688 (MainThread): 
2021-06-06 16:58:18.612687 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_school_and_country_country.sql
2021-06-06 16:58:18.614686 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-06-06 16:58:18.620690 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A112F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A13AB400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A13AB190>]}
2021-06-06 16:58:18.620690 (MainThread): Flushing usage events
2021-06-06 17:00:02.900681 (MainThread): Running with dbt=0.18.2
2021-06-06 17:00:03.103681 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-06 17:00:03.104681 (MainThread): Tracking: tracking
2021-06-06 17:00:03.105681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1F69F9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1F767370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1F767310>]}
2021-06-06 17:00:03.144172 (MainThread): Partial parsing not enabled
2021-06-06 17:00:03.146172 (MainThread): Parsing macros\adapters.sql
2021-06-06 17:00:03.190171 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 17:00:03.204172 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 17:00:03.237173 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 17:00:03.253539 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 17:00:03.259524 (MainThread): Parsing macros\core.sql
2021-06-06 17:00:03.266052 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 17:00:03.351044 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 17:00:03.370044 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 17:00:03.373047 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 17:00:03.377046 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 17:00:03.382047 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 17:00:03.386044 (MainThread): Parsing macros\etc\query.sql
2021-06-06 17:00:03.388053 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 17:00:03.407044 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 17:00:03.436047 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 17:00:03.440047 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 17:00:03.452044 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 17:00:03.493044 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 17:00:03.543044 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 17:00:03.547046 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 17:00:03.590047 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 17:00:03.608088 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 17:00:03.623046 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 17:00:03.641481 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 17:00:03.649475 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 17:00:03.654474 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 17:00:03.660470 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 17:00:03.679469 (MainThread): Partial parsing not enabled
2021-06-06 17:00:03.764026 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 17:00:03.807028 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 17:00:03.826030 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 17:00:03.846026 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 17:00:04.289782 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.test_model
- models.staging
- models.marts
- seeds.test_model

2021-06-06 17:00:04.435365 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 17:00:04.438365 (MainThread): 
2021-06-06 17:00:04.441364 (MainThread): Acquiring new vertica connection "master".
2021-06-06 17:00:04.495367 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 17:00:04.514368 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 17:00:04.514368 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 17:00:04.514368 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 17:00:04.538436 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 17:00:04.542825 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 17:00:04.542825 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 17:00:04.543368 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 17:00:04.565957 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 17:00:04.584893 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 17:00:04.589109 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 17:00:04.592565 (MainThread): 21:00:04 | Concurrency: 1 threads (target='dev')
2021-06-06 17:00:04.593631 (MainThread): 21:00:04 | 
2021-06-06 17:00:04.606992 (Thread-1): Began running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:00:04.606992 (Thread-1): 21:00:04 | 1 of 6 START test not_null_cwurData_country.......................... [RUN]
2021-06-06 17:00:04.607993 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 17:00:04.607993 (Thread-1): Compiling test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:00:04.645876 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_cwurData_country"
2021-06-06 17:00:04.647879 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.647879 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 17:00:04.648878 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: BEGIN
2021-06-06 17:00:04.648878 (Thread-1): Opening a new connection, currently in state init
2021-06-06 17:00:04.659137 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:00:04.663567 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:00:04.663567 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 17:00:04.664129 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_cwurData_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."cwurData"
where country is null



2021-06-06 17:00:04.677711 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:00:04.677711 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.678712 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: ROLLBACK
2021-06-06 17:00:04.682711 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: Close
2021-06-06 17:00:04.683719 (Thread-1): 21:00:04 | 1 of 6 PASS not_null_cwurData_country................................ [PASS in 0.08s]
2021-06-06 17:00:04.685711 (Thread-1): Finished running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:00:04.685711 (Thread-1): Began running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:00:04.686718 (Thread-1): 21:00:04 | 2 of 6 START test not_null_school_and_country_table_country.......... [RUN]
2021-06-06 17:00:04.687713 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 17:00:04.687713 (Thread-1): Compiling test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:00:04.703716 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_school_and_country_table_country"
2021-06-06 17:00:04.705712 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.706717 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 17:00:04.706717 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: BEGIN
2021-06-06 17:00:04.706717 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:00:04.718658 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:00:04.724535 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:00:04.724535 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 17:00:04.725086 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."school_and_country_table"
where country is null



2021-06-06 17:00:04.736175 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:00:04.736712 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.736712 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: ROLLBACK
2021-06-06 17:00:04.741764 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: Close
2021-06-06 17:00:04.742910 (Thread-1): 21:00:04 | 2 of 6 PASS not_null_school_and_country_table_country................ [PASS in 0.05s]
2021-06-06 17:00:04.744563 (Thread-1): Finished running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:00:04.745024 (Thread-1): Began running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:00:04.746150 (Thread-1): 21:00:04 | 3 of 6 START test not_null_stg_cwurdata_institution.................. [RUN]
2021-06-06 17:00:04.746807 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 17:00:04.747368 (Thread-1): Compiling test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:00:04.770124 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_cwurdata_institution"
2021-06-06 17:00:04.772123 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.773121 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 17:00:04.773121 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: BEGIN
2021-06-06 17:00:04.774129 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:00:04.786392 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:00:04.792612 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:00:04.793156 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 17:00:04.793156 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_cwurdata"
where institution is null



2021-06-06 17:00:04.807242 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:00:04.807732 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.807732 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: ROLLBACK
2021-06-06 17:00:04.812815 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: Close
2021-06-06 17:00:04.813945 (Thread-1): 21:00:04 | 3 of 6 PASS not_null_stg_cwurdata_institution........................ [PASS in 0.07s]
2021-06-06 17:00:04.815744 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:00:04.816297 (Thread-1): Began running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:00:04.816918 (Thread-1): 21:00:04 | 4 of 6 START test not_null_stg_school_and_country_country............ [RUN]
2021-06-06 17:00:04.817998 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 17:00:04.818506 (Thread-1): Compiling test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:00:04.835629 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_school_and_country_country"
2021-06-06 17:00:04.838640 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.839637 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 17:00:04.839637 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: BEGIN
2021-06-06 17:00:04.839637 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:00:04.853846 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:00:04.859272 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:00:04.859272 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 17:00:04.859814 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_school_and_country"
where country is null



2021-06-06 17:00:04.872170 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:00:04.872725 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.873266 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: ROLLBACK
2021-06-06 17:00:04.877620 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: Close
2021-06-06 17:00:04.878853 (Thread-1): 21:00:04 | 4 of 6 PASS not_null_stg_school_and_country_country.................. [PASS in 0.06s]
2021-06-06 17:00:04.881166 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:00:04.881758 (Thread-1): Began running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 17:00:04.882327 (Thread-1): 21:00:04 | 5 of 6 START test unique_stg_cwurdata_institution.................... [RUN]
2021-06-06 17:00:04.883471 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 17:00:04.884023 (Thread-1): Compiling test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 17:00:04.903573 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_cwurdata_institution"
2021-06-06 17:00:04.907592 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.909579 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 17:00:04.909579 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: BEGIN
2021-06-06 17:00:04.909579 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:00:04.922494 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:00:04.927088 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:00:04.927088 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_cwurdata_institution".
2021-06-06 17:00:04.927636 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from (

    select
        institution

    from "docker"."dbt_schema"."stg_cwurdata"
    where institution is not null
    group by institution
    having count(*) > 1

) validation_errors



2021-06-06 17:00:04.961033 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 17:00:04.961571 (Thread-1): finished collecting timing info
2021-06-06 17:00:04.961571 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: ROLLBACK
2021-06-06 17:00:04.966656 (Thread-1): On test.vertica_test_project.unique_stg_cwurdata_institution: Close
2021-06-06 17:00:04.967842 (Thread-1): 21:00:04 | 5 of 6 FAIL 1024 unique_stg_cwurdata_institution..................... [FAIL 1024 in 0.08s]
2021-06-06 17:00:04.969726 (Thread-1): Finished running node test.vertica_test_project.unique_stg_cwurdata_institution
2021-06-06 17:00:04.970277 (Thread-1): Began running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 17:00:04.971072 (Thread-1): 21:00:04 | 6 of 6 START test unique_stg_school_and_country_country.............. [RUN]
2021-06-06 17:00:04.972182 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 17:00:04.972736 (Thread-1): Compiling test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 17:00:05.001795 (Thread-1): Writing injected SQL for node "test.vertica_test_project.unique_stg_school_and_country_country"
2021-06-06 17:00:05.005820 (Thread-1): finished collecting timing info
2021-06-06 17:00:05.006792 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 17:00:05.006792 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: BEGIN
2021-06-06 17:00:05.006792 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:00:05.020329 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:00:05.024745 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:00:05.025300 (Thread-1): Using vertica connection "test.vertica_test_project.unique_stg_school_and_country_country".
2021-06-06 17:00:05.025300 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.unique_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from (

    select
        country

    from "docker"."dbt_schema"."stg_school_and_country"
    where country is not null
    group by country
    having count(*) > 1

) validation_errors



2021-06-06 17:00:05.051068 (Thread-1): SQL status: -1 in 0.03 seconds
2021-06-06 17:00:05.051068 (Thread-1): finished collecting timing info
2021-06-06 17:00:05.052081 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: ROLLBACK
2021-06-06 17:00:05.056365 (Thread-1): On test.vertica_test_project.unique_stg_school_and_country_country: Close
2021-06-06 17:00:05.058155 (Thread-1): 21:00:05 | 6 of 6 FAIL 51 unique_stg_school_and_country_country................. [FAIL 51 in 0.09s]
2021-06-06 17:00:05.060109 (Thread-1): Finished running node test.vertica_test_project.unique_stg_school_and_country_country
2021-06-06 17:00:05.062479 (MainThread): Acquiring new vertica connection "master".
2021-06-06 17:00:05.063631 (MainThread): 21:00:05 | 
2021-06-06 17:00:05.064175 (MainThread): 21:00:05 | Finished running 6 tests in 0.62s.
2021-06-06 17:00:05.064737 (MainThread): Connection 'master' was properly closed.
2021-06-06 17:00:05.065318 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 17:00:05.065318 (MainThread): Connection 'test.vertica_test_project.unique_stg_school_and_country_country' was properly closed.
2021-06-06 17:00:05.104778 (MainThread): 
2021-06-06 17:00:05.105777 (MainThread): Completed with 2 errors and 0 warnings:
2021-06-06 17:00:05.108780 (MainThread): 
2021-06-06 17:00:05.114781 (MainThread): Failure in test unique_stg_cwurdata_institution (models\staging\schema.yml)
2021-06-06 17:00:05.115778 (MainThread):   Got 1024 results, expected 0.
2021-06-06 17:00:05.119802 (MainThread): 
2021-06-06 17:00:05.126779 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_cwurdata_institution.sql
2021-06-06 17:00:05.129789 (MainThread): 
2021-06-06 17:00:05.130780 (MainThread): Failure in test unique_stg_school_and_country_country (models\staging\schema.yml)
2021-06-06 17:00:05.143111 (MainThread):   Got 51 results, expected 0.
2021-06-06 17:00:05.145299 (MainThread): 
2021-06-06 17:00:05.150683 (MainThread):   compiled SQL at target\compiled\vertica_test_project\models\staging\schema.yml\schema_test\unique_stg_school_and_country_country.sql
2021-06-06 17:00:05.151695 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-06-06 17:00:05.157694 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1FA08580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1FB1BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1FB1BBE0>]}
2021-06-06 17:00:05.158698 (MainThread): Flushing usage events
2021-06-06 17:02:13.326650 (MainThread): Running with dbt=0.18.2
2021-06-06 17:02:13.553944 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-06 17:02:13.555952 (MainThread): Tracking: tracking
2021-06-06 17:02:13.555952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120A1DF640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120A2A8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120A2A84F0>]}
2021-06-06 17:02:13.609943 (MainThread): Partial parsing not enabled
2021-06-06 17:02:13.612944 (MainThread): Parsing macros\adapters.sql
2021-06-06 17:02:13.667944 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 17:02:13.686946 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 17:02:13.728202 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 17:02:13.747969 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 17:02:13.756959 (MainThread): Parsing macros\core.sql
2021-06-06 17:02:13.767958 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 17:02:13.920632 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 17:02:13.950633 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 17:02:13.953630 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 17:02:13.960634 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 17:02:13.969633 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 17:02:13.977630 (MainThread): Parsing macros\etc\query.sql
2021-06-06 17:02:13.981630 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 17:02:14.013630 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 17:02:14.061633 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 17:02:14.069632 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 17:02:14.089631 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 17:02:14.143628 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 17:02:14.213629 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 17:02:14.221233 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 17:02:14.266896 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 17:02:14.285893 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 17:02:14.296901 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 17:02:14.313891 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 17:02:14.324240 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 17:02:14.329869 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 17:02:14.335241 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 17:02:14.354242 (MainThread): Partial parsing not enabled
2021-06-06 17:02:14.444822 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 17:02:14.492821 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 17:02:14.522826 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 17:02:14.545831 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 17:02:15.057995 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.marts
- models.test_model
- models.staging
- seeds.test_model

2021-06-06 17:02:15.186339 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 17:02:15.190341 (MainThread): 
2021-06-06 17:02:15.191347 (MainThread): Acquiring new vertica connection "master".
2021-06-06 17:02:15.231539 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 17:02:15.248519 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 17:02:15.249526 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: BEGIN
2021-06-06 17:02:15.249526 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 17:02:15.272929 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 17:02:15.279188 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 17:02:15.279188 (ThreadPoolExecutor-1_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 17:02:15.279695 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 17:02:15.304928 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.03 seconds
2021-06-06 17:02:15.325735 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 17:02:15.329623 (ThreadPoolExecutor-1_0): On list_docker_dbt_schema: Close
2021-06-06 17:02:15.332962 (MainThread): 21:02:15 | Concurrency: 1 threads (target='dev')
2021-06-06 17:02:15.333513 (MainThread): 21:02:15 | 
2021-06-06 17:02:15.349433 (Thread-1): Began running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:02:15.350433 (Thread-1): 21:02:15 | 1 of 4 START test not_null_cwurData_country.......................... [RUN]
2021-06-06 17:02:15.351434 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 17:02:15.351434 (Thread-1): Compiling test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:02:15.393432 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_cwurData_country"
2021-06-06 17:02:15.395433 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.395433 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 17:02:15.395433 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: BEGIN
2021-06-06 17:02:15.395433 (Thread-1): Opening a new connection, currently in state init
2021-06-06 17:02:15.406562 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:02:15.411312 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:02:15.411891 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 17:02:15.411891 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_cwurData_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."cwurData"
where country is null



2021-06-06 17:02:15.424964 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:02:15.425966 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.425966 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: ROLLBACK
2021-06-06 17:02:15.429965 (Thread-1): On test.vertica_test_project.not_null_cwurData_country: Close
2021-06-06 17:02:15.430964 (Thread-1): 21:02:15 | 1 of 4 PASS not_null_cwurData_country................................ [PASS in 0.08s]
2021-06-06 17:02:15.432968 (Thread-1): Finished running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:02:15.433964 (Thread-1): Began running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:02:15.433964 (Thread-1): 21:02:15 | 2 of 4 START test not_null_school_and_country_table_country.......... [RUN]
2021-06-06 17:02:15.434965 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 17:02:15.434965 (Thread-1): Compiling test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:02:15.453966 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_school_and_country_table_country"
2021-06-06 17:02:15.455978 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.455978 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 17:02:15.455978 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: BEGIN
2021-06-06 17:02:15.455978 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:02:15.467616 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:02:15.472686 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:02:15.472686 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 17:02:15.472686 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_school_and_country_table_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."school_and_country_table"
where country is null



2021-06-06 17:02:15.484710 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:02:15.484750 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.485285 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: ROLLBACK
2021-06-06 17:02:15.489861 (Thread-1): On test.vertica_test_project.not_null_school_and_country_table_country: Close
2021-06-06 17:02:15.491048 (Thread-1): 21:02:15 | 2 of 4 PASS not_null_school_and_country_table_country................ [PASS in 0.06s]
2021-06-06 17:02:15.493170 (Thread-1): Finished running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:02:15.493717 (Thread-1): Began running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:02:15.494275 (Thread-1): 21:02:15 | 3 of 4 START test not_null_stg_cwurdata_institution.................. [RUN]
2021-06-06 17:02:15.495367 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 17:02:15.495873 (Thread-1): Compiling test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:02:15.517200 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_cwurdata_institution"
2021-06-06 17:02:15.519202 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.520202 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 17:02:15.520202 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: BEGIN
2021-06-06 17:02:15.520202 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:02:15.532508 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:02:15.536947 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:02:15.537487 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 17:02:15.537487 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_cwurdata_institution"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_cwurdata"
where institution is null



2021-06-06 17:02:15.550320 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:02:15.550871 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.551408 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: ROLLBACK
2021-06-06 17:02:15.555814 (Thread-1): On test.vertica_test_project.not_null_stg_cwurdata_institution: Close
2021-06-06 17:02:15.556925 (Thread-1): 21:02:15 | 3 of 4 PASS not_null_stg_cwurdata_institution........................ [PASS in 0.06s]
2021-06-06 17:02:15.559184 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:02:15.559206 (Thread-1): Began running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:02:15.560323 (Thread-1): 21:02:15 | 4 of 4 START test not_null_stg_school_and_country_country............ [RUN]
2021-06-06 17:02:15.560879 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 17:02:15.561385 (Thread-1): Compiling test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:02:15.576772 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_school_and_country_country"
2021-06-06 17:02:15.580773 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.582785 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 17:02:15.583766 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: BEGIN
2021-06-06 17:02:15.583766 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 17:02:15.595160 (Thread-1): :P Connected to database: docker at localhost
2021-06-06 17:02:15.601173 (Thread-1): SQL status: -1 in 0.02 seconds
2021-06-06 17:02:15.601764 (Thread-1): Using vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 17:02:15.601764 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "node_id": "test.vertica_test_project.not_null_stg_school_and_country_country"} */

    
    



select count(*) as validation_errors
from "docker"."dbt_schema"."stg_school_and_country"
where country is null



2021-06-06 17:02:15.615000 (Thread-1): SQL status: -1 in 0.01 seconds
2021-06-06 17:02:15.615573 (Thread-1): finished collecting timing info
2021-06-06 17:02:15.615573 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: ROLLBACK
2021-06-06 17:02:15.619949 (Thread-1): On test.vertica_test_project.not_null_stg_school_and_country_country: Close
2021-06-06 17:02:15.621565 (Thread-1): 21:02:15 | 4 of 4 PASS not_null_stg_school_and_country_country.................. [PASS in 0.06s]
2021-06-06 17:02:15.623145 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:02:15.625385 (MainThread): Acquiring new vertica connection "master".
2021-06-06 17:02:15.626476 (MainThread): 21:02:15 | 
2021-06-06 17:02:15.627037 (MainThread): 21:02:15 | Finished running 4 tests in 0.43s.
2021-06-06 17:02:15.628142 (MainThread): Connection 'master' was properly closed.
2021-06-06 17:02:15.628142 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 17:02:15.628700 (MainThread): Connection 'test.vertica_test_project.not_null_stg_school_and_country_country' was properly closed.
2021-06-06 17:02:15.655026 (MainThread): 
2021-06-06 17:02:15.656024 (MainThread): Completed successfully
2021-06-06 17:02:15.660022 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-06 17:02:15.669031 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120A6D0DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120A670310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120A670940>]}
2021-06-06 17:02:15.669031 (MainThread): Flushing usage events
2021-06-06 17:02:58.712622 (MainThread): Running with dbt=0.18.2
2021-06-06 17:02:58.940431 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-06-06 17:02:58.942424 (MainThread): Tracking: tracking
2021-06-06 17:02:58.943425 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E26FE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E27C64F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E27C63D0>]}
2021-06-06 17:02:58.996433 (MainThread): Partial parsing not enabled
2021-06-06 17:02:58.999424 (MainThread): Parsing macros\adapters.sql
2021-06-06 17:02:59.054201 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-06 17:02:59.073202 (MainThread): Parsing macros\materializations\seed.sql
2021-06-06 17:02:59.110202 (MainThread): Parsing macros\materializations\table.sql
2021-06-06 17:02:59.124206 (MainThread): Parsing macros\materializations\view.sql
2021-06-06 17:02:59.131206 (MainThread): Parsing macros\core.sql
2021-06-06 17:02:59.144204 (MainThread): Parsing macros\adapters\common.sql
2021-06-06 17:02:59.257199 (MainThread): Parsing macros\etc\datetime.sql
2021-06-06 17:02:59.279201 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-06 17:02:59.282203 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-06 17:02:59.288202 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-06 17:02:59.295202 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-06 17:02:59.301203 (MainThread): Parsing macros\etc\query.sql
2021-06-06 17:02:59.304202 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-06 17:02:59.327202 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-06 17:02:59.363939 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-06 17:02:59.368761 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-06 17:02:59.384760 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-06 17:02:59.438627 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-06 17:02:59.506811 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-06 17:02:59.513382 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-06 17:02:59.553860 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-06 17:02:59.567862 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-06 17:02:59.583859 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-06 17:02:59.601861 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-06 17:02:59.609865 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-06 17:02:59.615860 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-06 17:02:59.621862 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-06 17:02:59.640863 (MainThread): Partial parsing not enabled
2021-06-06 17:02:59.735865 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 17:02:59.790863 (MainThread): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 17:02:59.813863 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 17:02:59.831862 (MainThread): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 17:03:00.293669 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.marts
- models.test_model
- models.staging
- seeds.test_model

2021-06-06 17:03:00.434685 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 141 macros, 0 operations, 6 seed files, 0 sources
2021-06-06 17:03:00.436695 (MainThread): 
2021-06-06 17:03:00.438685 (MainThread): Acquiring new vertica connection "master".
2021-06-06 17:03:00.481689 (ThreadPoolExecutor-0_0): Acquiring new vertica connection "list_docker_dbt_schema".
2021-06-06 17:03:00.503687 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 17:03:00.504686 (ThreadPoolExecutor-0_0): On list_docker_dbt_schema: BEGIN
2021-06-06 17:03:00.504686 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 17:03:00.533579 (ThreadPoolExecutor-0_0): :P Connected to database: docker at localhost
2021-06-06 17:03:00.537426 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.03 seconds
2021-06-06 17:03:00.537981 (ThreadPoolExecutor-0_0): Using vertica connection "list_docker_dbt_schema".
2021-06-06 17:03:00.537981 (ThreadPoolExecutor-0_0): On list_docker_dbt_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "list_docker_dbt_schema"} */
select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'dbt_schema'
    union all
    select
      'docker' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'dbt_schema'
  
2021-06-06 17:03:00.560450 (ThreadPoolExecutor-0_0): SQL status: -1 in 0.02 seconds
2021-06-06 17:03:00.579353 (ThreadPoolExecutor-0_0): On list_docker_dbt_schema: ROLLBACK
2021-06-06 17:03:00.584091 (ThreadPoolExecutor-0_0): On list_docker_dbt_schema: Close
2021-06-06 17:03:00.587349 (MainThread): 21:03:00 | Concurrency: 1 threads (target='dev')
2021-06-06 17:03:00.588498 (MainThread): 21:03:00 | 
2021-06-06 17:03:00.601962 (Thread-1): Began running node seed.vertica_test_project.cwurData
2021-06-06 17:03:00.603968 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.cwurData".
2021-06-06 17:03:00.603968 (Thread-1): Compiling seed.vertica_test_project.cwurData
2021-06-06 17:03:00.647960 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.648959 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.649966 (Thread-1): Finished running node seed.vertica_test_project.cwurData
2021-06-06 17:03:00.649966 (Thread-1): Began running node seed.vertica_test_project.school_and_country_table
2021-06-06 17:03:00.650962 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.school_and_country_table".
2021-06-06 17:03:00.650962 (Thread-1): Compiling seed.vertica_test_project.school_and_country_table
2021-06-06 17:03:00.664962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.665961 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.666961 (Thread-1): Finished running node seed.vertica_test_project.school_and_country_table
2021-06-06 17:03:00.666961 (Thread-1): Began running node seed.vertica_test_project.education_expenditure_supplementary_data
2021-06-06 17:03:00.667961 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.education_expenditure_supplementary_data".
2021-06-06 17:03:00.667961 (Thread-1): Compiling seed.vertica_test_project.education_expenditure_supplementary_data
2021-06-06 17:03:00.676965 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.676965 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.677963 (Thread-1): Finished running node seed.vertica_test_project.education_expenditure_supplementary_data
2021-06-06 17:03:00.677963 (Thread-1): Began running node seed.vertica_test_project.educational_attainment_supplementary_data
2021-06-06 17:03:00.678961 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.educational_attainment_supplementary_data".
2021-06-06 17:03:00.678961 (Thread-1): Compiling seed.vertica_test_project.educational_attainment_supplementary_data
2021-06-06 17:03:00.692962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.692962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.693964 (Thread-1): Finished running node seed.vertica_test_project.educational_attainment_supplementary_data
2021-06-06 17:03:00.694964 (Thread-1): Began running node seed.vertica_test_project.shanghaiData
2021-06-06 17:03:00.695964 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.shanghaiData".
2021-06-06 17:03:00.695964 (Thread-1): Compiling seed.vertica_test_project.shanghaiData
2021-06-06 17:03:00.707960 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.707960 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.708961 (Thread-1): Finished running node seed.vertica_test_project.shanghaiData
2021-06-06 17:03:00.709961 (Thread-1): Began running node seed.vertica_test_project.timesData
2021-06-06 17:03:00.709961 (Thread-1): Acquiring new vertica connection "seed.vertica_test_project.timesData".
2021-06-06 17:03:00.710964 (Thread-1): Compiling seed.vertica_test_project.timesData
2021-06-06 17:03:00.721963 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.722963 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.722963 (Thread-1): Finished running node seed.vertica_test_project.timesData
2021-06-06 17:03:00.723961 (Thread-1): Began running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 17:03:00.723961 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_of_university_percent".
2021-06-06 17:03:00.723961 (Thread-1): Compiling model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 17:03:00.757962 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_of_university_percent"
2021-06-06 17:03:00.759962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.759962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.760963 (Thread-1): Finished running node model.vertica_test_project.mrt_country_of_university_percent
2021-06-06 17:03:00.760963 (Thread-1): Began running node model.vertica_test_project.stg_cwurdata
2021-06-06 17:03:00.761961 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_cwurdata".
2021-06-06 17:03:00.761961 (Thread-1): Compiling model.vertica_test_project.stg_cwurdata
2021-06-06 17:03:00.780966 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_cwurdata"
2021-06-06 17:03:00.782977 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.783964 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.783964 (Thread-1): Finished running node model.vertica_test_project.stg_cwurdata
2021-06-06 17:03:00.784965 (Thread-1): Began running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:03:00.785964 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_cwurData_country".
2021-06-06 17:03:00.785964 (Thread-1): Compiling test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:03:00.817961 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_cwurData_country"
2021-06-06 17:03:00.819962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.820962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.820962 (Thread-1): Finished running node test.vertica_test_project.not_null_cwurData_country
2021-06-06 17:03:00.821961 (Thread-1): Began running node model.vertica_test_project.mrt_country_percent
2021-06-06 17:03:00.821961 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.mrt_country_percent".
2021-06-06 17:03:00.822962 (Thread-1): Compiling model.vertica_test_project.mrt_country_percent
2021-06-06 17:03:00.838965 (Thread-1): Writing injected SQL for node "model.vertica_test_project.mrt_country_percent"
2021-06-06 17:03:00.840966 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.841963 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.841963 (Thread-1): Finished running node model.vertica_test_project.mrt_country_percent
2021-06-06 17:03:00.842963 (Thread-1): Began running node model.vertica_test_project.stg_school_and_country
2021-06-06 17:03:00.842963 (Thread-1): Acquiring new vertica connection "model.vertica_test_project.stg_school_and_country".
2021-06-06 17:03:00.843964 (Thread-1): Compiling model.vertica_test_project.stg_school_and_country
2021-06-06 17:03:00.861962 (Thread-1): Writing injected SQL for node "model.vertica_test_project.stg_school_and_country"
2021-06-06 17:03:00.863963 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.864962 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.865962 (Thread-1): Finished running node model.vertica_test_project.stg_school_and_country
2021-06-06 17:03:00.865962 (Thread-1): Began running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:03:00.866961 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_school_and_country_table_country".
2021-06-06 17:03:00.866961 (Thread-1): Compiling test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:03:00.882975 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_school_and_country_table_country"
2021-06-06 17:03:00.884965 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.884965 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.885963 (Thread-1): Finished running node test.vertica_test_project.not_null_school_and_country_table_country
2021-06-06 17:03:00.885963 (Thread-1): Began running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:03:00.885963 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_cwurdata_institution".
2021-06-06 17:03:00.886965 (Thread-1): Compiling test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:03:00.905965 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_cwurdata_institution"
2021-06-06 17:03:00.907966 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.907966 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.908962 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_cwurdata_institution
2021-06-06 17:03:00.909963 (Thread-1): Began running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:03:00.909963 (Thread-1): Acquiring new vertica connection "test.vertica_test_project.not_null_stg_school_and_country_country".
2021-06-06 17:03:00.910965 (Thread-1): Compiling test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:03:00.930564 (Thread-1): Writing injected SQL for node "test.vertica_test_project.not_null_stg_school_and_country_country"
2021-06-06 17:03:00.933575 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.933575 (Thread-1): finished collecting timing info
2021-06-06 17:03:00.934576 (Thread-1): Finished running node test.vertica_test_project.not_null_stg_school_and_country_country
2021-06-06 17:03:00.936575 (MainThread): Connection 'master' was properly closed.
2021-06-06 17:03:00.936575 (MainThread): Connection 'list_docker_dbt_schema' was properly closed.
2021-06-06 17:03:00.936575 (MainThread): Connection 'test.vertica_test_project.not_null_stg_school_and_country_country' was properly closed.
2021-06-06 17:03:01.012924 (MainThread): 21:03:01 | Done.
2021-06-06 17:03:01.024406 (MainThread): Acquiring new vertica connection "generate_catalog".
2021-06-06 17:03:01.024952 (MainThread): 21:03:01 | Building catalog
2021-06-06 17:03:01.117587 (ThreadPoolExecutor-1_0): Acquiring new vertica connection "docker.information_schema".
2021-06-06 17:03:01.132589 (ThreadPoolExecutor-1_0): Using vertica connection "docker.information_schema".
2021-06-06 17:03:01.132589 (ThreadPoolExecutor-1_0): On docker.information_schema: BEGIN
2021-06-06 17:03:01.132589 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 17:03:01.145175 (ThreadPoolExecutor-1_0): :P Connected to database: docker at localhost
2021-06-06 17:03:01.150201 (ThreadPoolExecutor-1_0): SQL status: -1 in 0.02 seconds
2021-06-06 17:03:01.150747 (ThreadPoolExecutor-1_0): Using vertica connection "docker.information_schema".
2021-06-06 17:03:01.150747 (ThreadPoolExecutor-1_0): On docker.information_schema: /* {"app": "dbt", "dbt_version": "0.18.2", "profile_name": "vertica_test_project", "target_name": "dev", "connection_name": "docker.information_schema"} */

    
    select 
    'docker' table_database
    , tab.table_schema
    , tab.table_name
    , 'TABLE' table_type
    , comment table_comment
    , tab.owner_name table_owner
    , col.column_name 
    , col.ordinal_position column_index
    , col.data_type column_type
    , nullif('','') column_comment
    from v_catalog.tables tab
    join v_catalog.columns col on tab.table_id = col.table_id 
    left join v_catalog.comments on tab.table_id = object_id
    where not(tab.is_system_table) and
        (lower(tab.table_schema) = lower('dbt_schema'))
    union all
    select 
    'docker' table_database
    , vw.table_schema
    , vw.table_name
    , 'VIEW' table_type
    , comment table_comment
    , vw.owner_name table_owner
    , col.column_name 
    , col.ordinal_position column_index
    , col.data_type column_type
    , nullif('','') column_comment
    from v_catalog.views vw
    join v_catalog.view_columns col on vw.table_id = col.table_id 
    left join v_catalog.comments on vw.table_id = object_id
    where not(vw.is_system_view) and
        (lower(vw.table_schema) = lower('dbt_schema'))
    order by table_schema, table_name, column_index 
    
  
2021-06-06 17:03:02.936473 (ThreadPoolExecutor-1_0): SQL status: -1 in 1.79 seconds
2021-06-06 17:03:02.959852 (ThreadPoolExecutor-1_0): On docker.information_schema: ROLLBACK
2021-06-06 17:03:02.967131 (ThreadPoolExecutor-1_0): On docker.information_schema: Close
2021-06-06 17:03:03.144004 (MainThread): 21:03:03 | Catalog written to C:\Users\davletova\vertica_test_project\dbt\target\catalog.json
2021-06-06 17:03:03.145004 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E26FE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E2C457C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E2BF75E0>]}
2021-06-06 17:03:03.146010 (MainThread): Flushing usage events
2021-06-06 17:03:03.820327 (MainThread): Connection 'generate_catalog' was properly closed.
2021-06-06 17:03:03.820327 (MainThread): Connection 'docker.information_schema' was properly closed.
2021-06-06 17:03:26.626943 (MainThread): Running with dbt=0.18.2
2021-06-06 17:03:26.859940 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\davletova\\.dbt', project_dir='C:\\Users\\davletova\\vertica_test_project\\dbt', record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-06-06 17:03:26.861939 (MainThread): Tracking: tracking
2021-06-06 17:03:26.862938 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FB51E700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FB5E61C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FB5E6220>]}
2021-06-06 17:03:26.867944 (MainThread): Serving docs at 0.0.0.0:8080
2021-06-06 17:03:26.868943 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-06-06 17:03:26.871939 (MainThread): Press Ctrl+C to exit.


